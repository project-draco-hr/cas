{
  final Optional<String> opClientId=getClientId(request);
  if (!opClientId.isPresent()) {
    logger.error("Missing clientId");
    return false;
  }
  final String clientId=opClientId.get();
  final OAuthRegisteredService service=OAuthUtils.getRegisteredOAuthService(this.servicesManager,clientId);
  final String redirectUri=request.getParameter(OAuthConstants.REDIRECT_URI);
  final String serviceId=service.getServiceId();
  logger.debug("Found: {} for: {} vs redirectUri: {}",service,clientId,redirectUri);
  if (!redirectUri.matches(serviceId)) {
    logger.error("Unsupported {}: {} for serviceId: {}",OAuthConstants.REDIRECT_URI,redirectUri,serviceId);
    return false;
  }
  return true;
}
