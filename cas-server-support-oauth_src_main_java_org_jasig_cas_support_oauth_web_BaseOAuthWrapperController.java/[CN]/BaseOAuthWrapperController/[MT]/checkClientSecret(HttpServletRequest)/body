{
  final String clientId=request.getParameter(OAuthConstants.CLIENT_ID);
  final OAuthRegisteredService service=OAuthUtils.getRegisteredOAuthService(this.servicesManager,clientId);
  final String clientSecret=request.getParameter(OAuthConstants.CLIENT_SECRET);
  logger.debug("Found: {} for: {} in secret check",service,clientId);
  if (!StringUtils.equals(service.getClientSecret(),clientSecret)) {
    logger.error("Wrong client secret for service: {}",service);
    return false;
  }
  return true;
}
