{
  final Optional<String> opClientId=getClientId(request);
  if (!opClientId.isPresent()) {
    logger.error("Missing clientId");
    return false;
  }
  final String clientId=opClientId.get();
  final OAuthRegisteredService service=OAuthUtils.getRegisteredOAuthService(this.servicesManager,clientId);
  logger.debug("Found: {} for: {}",service,clientId);
  if (service == null || !service.getAccessStrategy().isServiceAccessAllowed()) {
    logger.error("Service {} is not found in the registry or it is disabled.",clientId);
    return false;
  }
  return true;
}
