{
  final PrincipalFactory f=new DefaultPrincipalFactory(new DefaultPrincipalAttributesRepository(Collections.<String,Object>singletonMap("mail","final@example.com")));
  final Principal p=f.createPrincipal("uid");
  assertEquals(p.getId(),"uid");
  assertEquals(p.getAttributes().size(),1);
  assertTrue(p.getAttributes().containsKey("mail"));
}
