{
  try {
    final RegisteredServiceMultifactorAuthenticationProvider provider=getAuthenticationProviderForService(service);
    if (provider != null) {
      final String identifier=provider.provide(service);
      if (StringUtils.isBlank(identifier)) {
        logger.warn("Multifactor authentication provider {} could not provide CAS with its identifier.",provider);
        return null;
      }
      logger.debug("Attempting to build an event based on the authentication provider [{}] and service [{}]",provider,service.getName());
      final Event event=validateEventIdForMatchingTransitionInContext(identifier,context);
      return ImmutableSet.of(event);
    }
    return null;
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
}
