{
  final Map<String,Object> authnAttributes=new HashMap<>(getAuthenticationAttributesAsMultiValuedAttributes(model));
  if (isRememberMeAuthentication(model)) {
    authnAttributes.remove(RememberMeCredential.AUTHENTICATION_ATTRIBUTE_REMEMBER_ME);
    authnAttributes.put(this.rememberMeAttributeName,Boolean.TRUE.toString());
  }
  final Map<String,Object> attributesToReturn=new HashMap<>();
  attributesToReturn.putAll(getPrincipalAttributesAsMultiValuedAttributes(model));
  attributesToReturn.putAll(authnAttributes);
  return attributesToReturn;
}
