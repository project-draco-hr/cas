{
  final List<Client> allClients=new ArrayList<>();
  final Map<String,String> properties=new HashMap<>();
  properties.put(PropertiesConfigFactory.FACEBOOK_ID,casProperties.getAuthn().getPac4j().getFacebook().getId());
  properties.put(PropertiesConfigFactory.FACEBOOK_SECRET,casProperties.getAuthn().getPac4j().getFacebook().getSecret());
  properties.put(PropertiesConfigFactory.FACEBOOK_SCOPE,casProperties.getAuthn().getPac4j().getFacebook().getScope());
  properties.put(PropertiesConfigFactory.FACEBOOK_FIELDS,casProperties.getAuthn().getPac4j().getFacebook().getFields());
  properties.put(PropertiesConfigFactory.TWITTER_ID,casProperties.getAuthn().getPac4j().getTwitter().getId());
  properties.put(PropertiesConfigFactory.TWITTER_SECRET,casProperties.getAuthn().getPac4j().getTwitter().getSecret());
  properties.put(PropertiesConfigFactory.CAS_LOGIN_URL,casProperties.getAuthn().getPac4j().getCas().getLoginUrl());
  properties.put(PropertiesConfigFactory.CAS_PROTOCOL,casProperties.getAuthn().getPac4j().getCas().getProtocol());
  properties.put(PropertiesConfigFactory.SAML_IDENTITY_PROVIDER_METADATA_PATH,casProperties.getAuthn().getPac4j().getSaml().getIdentityProviderMetadataPath());
  properties.put(PropertiesConfigFactory.SAML_KEYSTORE_PASSWORD,casProperties.getAuthn().getPac4j().getSaml().getKeystorePassword());
  properties.put(PropertiesConfigFactory.SAML_KEYSTORE_PATH,casProperties.getAuthn().getPac4j().getSaml().getKeystorePath());
  properties.put(PropertiesConfigFactory.SAML_MAXIMUM_AUTHENTICATION_LIFETIME,casProperties.getAuthn().getPac4j().getSaml().getMaximumAuthenticationLifetime());
  properties.put(PropertiesConfigFactory.SAML_PRIVATE_KEY_PASSWORD,casProperties.getAuthn().getPac4j().getSaml().getPrivateKeyPassword());
  properties.put(PropertiesConfigFactory.SAML_SERVICE_PROVIDER_ENTITY_ID,casProperties.getAuthn().getPac4j().getSaml().getServiceProviderEntityId());
  properties.put(PropertiesConfigFactory.SAML_SERVICE_PROVIDER_METADATA_PATH,casProperties.getAuthn().getPac4j().getSaml().getServiceProviderEntityId());
  properties.put(PropertiesConfigFactory.OIDC_CUSTOM_PARAM_KEY1,casProperties.getAuthn().getPac4j().getOidc().getCustomParamKey1());
  properties.put(PropertiesConfigFactory.OIDC_CUSTOM_PARAM_KEY2,casProperties.getAuthn().getPac4j().getOidc().getCustomParamKey2());
  properties.put(PropertiesConfigFactory.OIDC_CUSTOM_PARAM_VALUE1,casProperties.getAuthn().getPac4j().getOidc().getCustomParamValue1());
  properties.put(PropertiesConfigFactory.OIDC_CUSTOM_PARAM_VALUE2,casProperties.getAuthn().getPac4j().getOidc().getCustomParamValue2());
  properties.put(PropertiesConfigFactory.OIDC_DISCOVERY_URI,casProperties.getAuthn().getPac4j().getOidc().getDiscoveryUri());
  properties.put(PropertiesConfigFactory.OIDC_ID,casProperties.getAuthn().getPac4j().getOidc().getId());
  properties.put(PropertiesConfigFactory.OIDC_MAX_CLOCK_SKEW,casProperties.getAuthn().getPac4j().getOidc().getMaxClockSkew());
  properties.put(PropertiesConfigFactory.OIDC_PREFERRED_JWS_ALGORITHM,casProperties.getAuthn().getPac4j().getOidc().getPreferredJwsAlgorithm());
  properties.put(PropertiesConfigFactory.OIDC_SECRET,casProperties.getAuthn().getPac4j().getOidc().getSecret());
  properties.put(PropertiesConfigFactory.OIDC_USE_NONCE,casProperties.getAuthn().getPac4j().getOidc().getUseNonce());
  final ConfigFactory configFactory=new PropertiesConfigFactory(properties);
  final Config propertiesConfig=configFactory.build();
  allClients.addAll(propertiesConfig.getClients().getClients());
  if (this.clients != null && this.clients.length > 0) {
    allClients.addAll(Arrays.<Client>asList(this.clients));
  }
  if (allClients.isEmpty()) {
    throw new IllegalArgumentException("At least one pac4j client must be defined");
  }
  return new Clients(casProperties.getServer().getLoginUrl(),allClients);
}
