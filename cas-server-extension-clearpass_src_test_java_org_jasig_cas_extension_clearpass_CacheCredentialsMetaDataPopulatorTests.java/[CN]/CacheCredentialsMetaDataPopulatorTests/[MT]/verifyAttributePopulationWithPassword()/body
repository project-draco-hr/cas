{
  final Authentication auth=TestUtils.getAuthentication();
  final Map<String,String> map=new HashMap<>();
  final CacheCredentialsMetaDataPopulator populator=new CacheCredentialsMetaDataPopulator(map);
  final UsernamePasswordCredential c=TestUtils.getCredentialsWithSameUsernameAndPassword();
  populator.populateAttributes(AuthenticationBuilder.newInstance(auth),c);
  assertTrue(map.containsKey(auth.getPrincipal().getId()));
  assertEquals(map.get(auth.getPrincipal().getId()),c.getPassword());
}
