{
  final String targetService=request.getParameter(CONST_PARAM_TARGET_SERVICE);
  final String service=request.getParameter(CONST_PARAM_SERVICE);
  final String serviceAttribute=(String)request.getAttribute(CONST_PARAM_SERVICE);
  final String method=request.getParameter(CONST_PARAM_METHOD);
  final String serviceToUse;
  if (StringUtils.hasText(targetService)) {
    serviceToUse=targetService;
  }
 else   if (StringUtils.hasText(service)) {
    serviceToUse=service;
  }
 else {
    serviceToUse=serviceAttribute;
  }
  if (!StringUtils.hasText(serviceToUse)) {
    return null;
  }
  final String id=cleanupUrl(serviceToUse);
  final String artifactId=request.getParameter(CONST_PARAM_TICKET);
  return new SimpleWebApplicationServiceImpl(id,serviceToUse,artifactId,"POST".equals(method) ? ResponseType.POST : ResponseType.REDIRECT);
}
