{
  final URL[] urls=getDistributionPoints(cert);
  logger.debug("Distribution points for {}: {}.",CertUtils.toString(cert),Arrays.asList(urls));
  try {
    for (    final URL url : urls) {
      final Element item=this.crlCache.get(url);
      if (item != null) {
        logger.debug("Found CRL in cache for {}",CertUtils.toString(cert));
        final byte[] encodedCrl=(byte[])item.getObjectValue();
        return this.fetcher.fetch(new ByteArrayResource(encodedCrl));
      }
    }
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
  X509CRL crl=null;
  for (int i=0; i < urls.length && crl == null; i++) {
    final URL url=urls[i];
    logger.info("Attempting to fetch CRL at {}",url);
    try {
      crl=this.fetcher.fetch(new UrlResource(url));
      logger.info("Success. Caching fetched CRL at {}.",url);
      this.fetcher.fetch(new ByteArrayResource(crl.getEncoded()));
      addCRL(url,crl);
    }
 catch (    final Exception e) {
      logger.error("Error fetching CRL at {}",url,e);
    }
  }
  return crl;
}
