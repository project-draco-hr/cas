{
  this.builder=new DefaultAuthenticationContextBuilder();
  final DefaultPrincipalElectionStrategy principalStrategy=new DefaultPrincipalElectionStrategy();
  principalStrategy.setPrincipalFactory(new DefaultPrincipalFactory());
  builder.setPrincipalElectionStrategy(principalStrategy);
  final AcceptUsersAuthenticationHandler handler=new AcceptUsersAuthenticationHandler();
  handler.setUsers(Collections.singletonMap("casuser","Mellon"));
  this.manager=new PolicyBasedAuthenticationManager(handler,new SimpleTestUsernamePasswordAuthenticationHandler());
  this.authenticationSupervisor=new DefaultAuthenticationSupervisor();
  this.authenticationSupervisor.setAuthenticationContextBuilder(this.builder);
  this.authenticationSupervisor.setAuthenticationManager(this.manager);
}
