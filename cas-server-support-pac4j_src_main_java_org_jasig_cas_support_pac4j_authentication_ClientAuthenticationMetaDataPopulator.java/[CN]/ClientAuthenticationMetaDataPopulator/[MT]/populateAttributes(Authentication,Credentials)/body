{
  if (credentials instanceof ClientCredentials) {
    final ClientCredentials clientCredentials=(ClientCredentials)credentials;
    final Principal simplePrincipal=new SimplePrincipal(authentication.getPrincipal().getId(),clientCredentials.getUserProfile().getAttributes());
    final MutableAuthentication mutableAuthentication=new MutableAuthentication(simplePrincipal,authentication.getAuthenticatedDate());
    mutableAuthentication.getAttributes().putAll(authentication.getAttributes());
    mutableAuthentication.getAttributes().put(CLIENT_NAME,clientCredentials.getCredentials().getClientName());
    return mutableAuthentication;
  }
  return authentication;
}
