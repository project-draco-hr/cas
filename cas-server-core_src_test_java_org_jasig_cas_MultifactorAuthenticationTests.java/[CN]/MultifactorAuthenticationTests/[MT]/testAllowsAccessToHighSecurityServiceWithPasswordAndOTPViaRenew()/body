{
  final String tgt=cas.createTicketGrantingTicket(newUserPassCredentials("alice","alice"));
  assertNotNull(tgt);
  final Service service=newService("https://example.com/high/");
  final String st=cas.grantServiceTicket(tgt,service,newUserPassCredentials("alice","alice"),new OneTimePasswordCredentials("alice","31415"));
  assertNotNull(st);
  final Assertion assertion=cas.validateServiceTicket(st,service);
  assertEquals(2,assertion.getPrimaryAuthentication().getSuccesses().size());
  assertTrue(assertion.getPrimaryAuthentication().getSuccesses().containsKey("passwordHandler"));
  assertTrue(assertion.getPrimaryAuthentication().getSuccesses().containsKey("oneTimePasswordHandler"));
  assertTrue(assertion.getPrimaryAuthentication().getAttributes().containsKey(SuccessfulHandlerMetaDataPopulator.SUCCESSFUL_AUTHENTICATION_HANDLERS));
}
