{
  final RegisteredServiceMultifactorPolicy policy=service.getAuthenticationPolicy();
  if (policy != null) {
    final Set<String> providers=policy.getMultifactorAuthenticationProviders();
    final Set<MultifactorAuthenticationProvider> providersSet=new HashSet<>(providers.size());
    for (    final String provider : providers) {
      final MultifactorAuthenticationProvider providerInst=getMultifactorAuthenticationProviderFromApplicationContext(provider);
      if (providerInst != null) {
        logger.debug("Added multifactor authentication provider {} as an available provider for {}",providerInst,service);
        providersSet.add(providerInst);
      }
    }
    return providersSet;
  }
  return null;
}
