{
  for (  final RadiusServer radiusServer : this.servers) {
    logger.debug("Attempting to authenticate {} at {}",username,radiusServer);
    try {
      if (radiusServer.authenticate(username,password)) {
        return new SimplePrincipal(username);
      }
 else       if (!this.failoverOnAuthenticationFailure) {
        throw new FailedLoginException();
      }
      logger.debug("failoverOnAuthenticationFailure enabled -- trying next server");
    }
 catch (    final PreventedException e) {
      if (!this.failoverOnException) {
        throw e;
      }
      logger.warn("failoverOnException enabled -- trying next server.",e);
    }
  }
  throw new FailedLoginException();
}
