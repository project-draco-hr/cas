{
  logger.debug("verifier : {}",verifier);
  logger.debug("token : {}",token);
  Token tokenRequest=(Token)session.getAttribute(name + "#tokenRequest");
  logger.debug("tokenRequest : {}",tokenRequest);
  if (tokenRequest == null) {
    throw new OAuthException("Token request expired");
  }
  String savedToken=tokenRequest.getToken();
  logger.debug("savedToken : {}",savedToken);
  if (!StringUtils.equals(token,savedToken)) {
    throw new OAuthException("Token received : " + token + " is different from saved token : "+ savedToken);
  }
  Verifier providerVerifier=new Verifier(verifier);
  Token accessToken=service.getAccessToken(tokenRequest,providerVerifier);
  logger.debug("accessToken : {}",accessToken);
  return accessToken;
}
