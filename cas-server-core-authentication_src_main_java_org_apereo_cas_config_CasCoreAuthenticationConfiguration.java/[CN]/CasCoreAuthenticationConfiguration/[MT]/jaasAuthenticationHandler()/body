{
  final JaasAuthenticationHandler h=new JaasAuthenticationHandler();
  h.setKerberosKdcSystemProperty(casProperties.getAuthn().getJaas().getKerberosKdcSystemProperty());
  h.setKerberosRealmSystemProperty(casProperties.getAuthn().getJaas().getKerberosRealmSystemProperty());
  h.setRealm(casProperties.getAuthn().getJaas().getRealm());
  h.setPasswordEncoder(Beans.newPasswordEncoder(casProperties.getAuthn().getJaas().getPasswordEncoder()));
  if (passwordPolicyConfiguration != null) {
    h.setPasswordPolicyConfiguration(passwordPolicyConfiguration);
  }
  if (principalNameTransformer != null) {
    h.setPrincipalNameTransformer(principalNameTransformer);
  }
  h.setPrincipalFactory(jaasPrincipalFactory());
  h.setServicesManager(servicesManager);
  return h;
}
