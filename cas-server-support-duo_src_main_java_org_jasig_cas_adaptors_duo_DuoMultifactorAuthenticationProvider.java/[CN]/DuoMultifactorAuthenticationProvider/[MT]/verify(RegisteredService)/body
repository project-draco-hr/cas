{
  if (duoAuthenticationService.canPing()) {
    return true;
  }
  final RegisteredServiceAuthenticationPolicy policy=service.getAuthenticationPolicy();
  if (policy != null && policy.isFailOpen()) {
    logger.warn("Duo could not be reached. Since the authentication provider is configured to fail-open, authentication will " + "proceed without Duo for service {}",service.getServiceId());
    return false;
  }
  throw new AuthenticationException();
}
