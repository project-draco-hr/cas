{
  if (duoAuthenticationService.canPing()) {
    return true;
  }
  final RegisteredServiceMultifactorPolicy policy=service.getMultifactorPolicy();
  if (policy != null && policy.getFailureMode() == RegisteredServiceMultifactorPolicy.FailureModes.OPEN) {
    logger.warn("Duo could not be reached. Since the authentication provider is configured to fail-open, authentication will " + "proceed without Duo for service {}",service.getServiceId());
    return false;
  }
  throw new AuthenticationException();
}
