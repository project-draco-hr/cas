{
  final MessageDigest messageDigest=DigestUtils.getDigest(this.algorithmName);
  messageDigest.reset();
  messageDigest.update(encodedPassword.getBytes());
  if (StringUtils.isNotBlank(this.staticSalt)) {
    messageDigest.update(this.staticSalt.getBytes());
  }
  if (!values.containsKey(this.saltFieldName)) {
    throw new RuntimeException("Specified field name for salt does not exist in the resultset");
  }
  messageDigest.update(values.get(this.saltFieldName).toString().getBytes());
  byte[] digestedPassword=messageDigest.digest();
  long numOfIterations=this.numberOfIterations;
  if (values.containsKey(this.numberOfIterationsFieldName)) {
    final String longAsStr=values.get(this.numberOfIterationsFieldName).toString();
    numOfIterations=Long.valueOf(longAsStr);
  }
  for (int i=0; i < numOfIterations - 1; i++) {
    messageDigest.reset();
    digestedPassword=messageDigest.digest(digestedPassword);
  }
  return digestedPassword;
}
