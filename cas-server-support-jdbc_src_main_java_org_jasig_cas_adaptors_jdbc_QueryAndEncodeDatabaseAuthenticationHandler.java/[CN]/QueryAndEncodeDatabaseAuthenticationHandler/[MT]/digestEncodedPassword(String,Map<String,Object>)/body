{
  this.messageDigest.update(encodedPassword.getBytes());
  if (StringUtils.isNotBlank(this.staticSalt)) {
    this.messageDigest.update(this.staticSalt.getBytes());
  }
  this.messageDigest.update(values.get(this.saltFieldName).toString().getBytes());
  byte[] digestedPassword=this.messageDigest.digest();
  long numOfIterations=this.numberOfIterations;
  if (values.containsKey(this.numberOfIterationsFieldName)) {
    numOfIterations=Long.decode(values.get(this.numberOfIterationsFieldName).toString());
  }
  for (int i=0; i < numOfIterations; i++) {
    this.messageDigest.reset();
    digestedPassword=this.messageDigest.digest(digestedPassword);
  }
  return digestedPassword;
}
