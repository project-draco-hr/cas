{
  if (!this.getAudience().equalsIgnoreCase(expectedAudience)) {
    logger.warn("Audience is invalid: {}",this.getAudience());
    return false;
  }
  if (!this.getIssuer().equalsIgnoreCase(expectedIssuer)) {
    logger.warn("Issuer is invalid: {}",this.getIssuer());
    return false;
  }
  final DateTime retrievedOnTimeDrift=this.getRetrievedOn().minusMillis(timeDrift);
  if (this.getIssuedOn().isBefore(retrievedOnTimeDrift)) {
    logger.warn("Ticket is issued before the allowed drift. Issued on {} while allowed drift is {}",this.getIssuedOn(),retrievedOnTimeDrift);
    return false;
  }
  final DateTime retrievedOnTimeAfterDrift=this.getRetrievedOn().plusMillis(timeDrift);
  if (this.getIssuedOn().isAfter(retrievedOnTimeAfterDrift)) {
    logger.warn("Ticket is issued after the allowed drift. Issued on {} while allowed drift is {}",this.getIssuedOn(),retrievedOnTimeAfterDrift);
    return false;
  }
  if (this.getRetrievedOn().isAfter(this.getNotOnOrAfter())) {
    logger.warn("Ticket is too late because it's retrieved on {} which is after {}.",this.getRetrievedOn(),this.getNotOnOrAfter());
    return false;
  }
  logger.debug("WsFed Credential is validated for {} and {}.",expectedAudience,expectedIssuer);
  return true;
}
