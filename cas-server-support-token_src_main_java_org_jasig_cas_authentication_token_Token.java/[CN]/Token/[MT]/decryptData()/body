{
  try {
    LOGGER.debug("Decrypting token [{}] with key [{}]",this.key.getName(),new String(this.key.getData().read()));
    final String decryptedString=Crypto.decryptEncodedStringWithKey(this.tokenData,this.key);
    final JSONObject jsonObject=new JSONObject(decryptedString);
    LOGGER.debug("Decrypted token: {}",jsonObject);
    this.generated=jsonObject.getLong("generated");
    this.attributes=new TokenAttributes(jsonObject.getJSONObject("credentials").toString(),this.requiredTokenAttributes,this.tokenAttributesMap);
    this.isDecoded=true;
    LOGGER.debug("Token is successfully decrypted.");
  }
 catch (  final Exception e) {
    LOGGER.error(e.getMessage(),e);
    throw e;
  }
}
