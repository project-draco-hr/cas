{
  final Map<String,Service> services;
synchronized (ticket) {
    services=ticket.getServices();
    ticket.removeAllServices();
  }
  ticket.markTicketExpired();
  final List<DefaultLogoutRequest> logoutRequests=new ArrayList<>();
  if (!this.singleLogoutCallbacksDisabled) {
    for (    final Map.Entry<String,Service> entry : services.entrySet()) {
      final Service service=entry.getValue();
      if (service instanceof SingleLogoutService) {
        final DefaultLogoutRequest logoutRequest=handleLogoutForSloService((SingleLogoutService)service,entry.getKey());
        if (logoutRequest != null) {
          LOGGER.debug("Captured logout request [{}]",logoutRequest);
          logoutRequests.add(logoutRequest);
        }
      }
    }
  }
  return logoutRequests;
}
