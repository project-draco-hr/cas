{
  CacheManager.getInstance().removeAllCaches();
  final Collection<Object[]> params=new ArrayList<>();
  Cache cache;
  final ThresholdExpiredCRLRevocationPolicy defaultPolicy=new ThresholdExpiredCRLRevocationPolicy();
  final ThresholdExpiredCRLRevocationPolicy zeroThresholdPolicy=new ThresholdExpiredCRLRevocationPolicy();
  zeroThresholdPolicy.setThreshold(0);
  cache=new Cache("crlCache-1",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  params.add(new Object[]{new CRLDistributionPointRevocationChecker(cache),defaultPolicy,new String[]{"user-valid-distcrl.crt"},"userCA-valid.crl",null});
  cache=new Cache("crlCache-2",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  params.add(new Object[]{new CRLDistributionPointRevocationChecker(cache),defaultPolicy,new String[]{"user-revoked-distcrl.crt"},"userCA-valid.crl",new RevokedCertificateException(new Date(),new BigInteger("1"))});
  cache=new Cache("crlCache-3",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  params.add(new Object[]{new CRLDistributionPointRevocationChecker(cache),zeroThresholdPolicy,new String[]{"user-valid-distcrl.crt"},"userCA-expired.crl",new ExpiredCRLException("test",new Date())});
  cache=new Cache("crlCache-4",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  params.add(new Object[]{new CRLDistributionPointRevocationChecker(cache),new RevocationPolicy<X509CRL>(){
    @Override public void apply(    final X509CRL crl){
    }
  }
,new String[]{"user-valid-distcrl.crt"},"userCA-expired.crl",null});
  cache=new Cache("crlCache-5",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  final CRLDistributionPointRevocationChecker checker5=new CRLDistributionPointRevocationChecker(cache);
  checker5.setUnavailableCRLPolicy(new AllowRevocationPolicy());
  params.add(new Object[]{checker5,defaultPolicy,new String[]{"user-valid.crt"},"userCA-expired.crl",null});
  cache=new Cache("crlCache-6",100,false,false,20,10);
  CacheManager.getInstance().addCache(cache);
  params.add(new Object[]{new CRLDistributionPointRevocationChecker(cache),defaultPolicy,new String[]{"user-revoked-distcrl2.crt"},"userCA-valid.crl",new RevokedCertificateException(new Date(),new BigInteger("1"))});
  return params;
}
