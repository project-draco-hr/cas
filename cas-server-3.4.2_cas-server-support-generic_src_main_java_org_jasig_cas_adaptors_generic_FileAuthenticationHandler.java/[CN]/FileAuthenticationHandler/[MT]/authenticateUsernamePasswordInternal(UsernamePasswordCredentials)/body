{
  BufferedReader bufferedReader=null;
  try {
    bufferedReader=new BufferedReader(new InputStreamReader(this.fileName.getInputStream()));
    String line=bufferedReader.readLine();
    while (line != null) {
      final String[] lineFields=line.split(this.separator);
      final String userName=lineFields[0];
      final String password=lineFields[1];
      final String transformedUsername=getPrincipalNameTransformer().transform(credentials.getUsername());
      if (transformedUsername.equals(userName)) {
        if (this.getPasswordEncoder().encode(credentials.getPassword()).equals(password)) {
          return true;
        }
        break;
      }
      line=bufferedReader.readLine();
    }
  }
 catch (  final Exception e) {
    log.error(e.getMessage(),e);
  }
 finally {
    try {
      if (bufferedReader != null) {
        bufferedReader.close();
      }
    }
 catch (    IOException e) {
      log.error(e.getMessage(),e);
    }
  }
  return false;
}
