{
  final String username=getPrincipalNameTransformer().transform(credentials.getUsername());
  final String password=credentials.getPassword();
  final String encryptedPassword=this.getPasswordEncoder().encode(password);
  try {
    final String dbPassword=getJdbcTemplate().queryForObject(this.sql,String.class,username);
    return dbPassword.equals(encryptedPassword);
  }
 catch (  final IncorrectResultSizeDataAccessException e) {
    return false;
  }
}
