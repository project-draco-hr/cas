{
  final Form form=new Form(entity);
  final String serviceUrl=form.getFirstValue("service");
  try {
    final ServiceTicket serviceTicketId=this.centralAuthenticationService.grantServiceTicket(this.ticketGrantingTicketId,new WebApplicationServiceFactory().createService(serviceUrl));
    getResponse().setEntity(serviceTicketId.getId(),MediaType.TEXT_PLAIN);
  }
 catch (  final InvalidTicketException e) {
    getResponse().setStatus(Status.CLIENT_ERROR_NOT_FOUND,"TicketGrantingTicket could not be found.");
  }
catch (  final Exception e) {
    LOGGER.error(e.getMessage(),e);
    getResponse().setStatus(Status.CLIENT_ERROR_BAD_REQUEST,e.getMessage());
  }
}
