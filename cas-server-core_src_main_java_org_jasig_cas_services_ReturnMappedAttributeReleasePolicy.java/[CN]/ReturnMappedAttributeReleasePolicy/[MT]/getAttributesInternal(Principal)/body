{
  final Map<String,Object> attributesToRelease=new HashMap<String,Object>(p.getAttributes().size());
  final Map<String,Object> resolvedAttributes=p.getAttributes();
  for (  final String attribute : this.allowedAttributes.keySet()) {
    final Object value=resolvedAttributes.get(attribute);
    if (value != null) {
      final String mappedAttributeName=this.allowedAttributes.get(attribute);
      logger.debug("Found attribute [{}] in the list of allowed attributes, mapped to the name [{}]",attribute,mappedAttributeName);
      attributesToRelease.put(mappedAttributeName,value);
    }
  }
  return attributesToRelease;
}
