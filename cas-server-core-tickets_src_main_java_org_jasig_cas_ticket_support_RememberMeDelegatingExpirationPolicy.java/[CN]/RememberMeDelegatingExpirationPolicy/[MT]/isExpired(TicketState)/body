{
  if (this.rememberMeExpirationPolicy != null && this.sessionExpirationPolicy != null) {
    final Boolean b=(Boolean)ticketState.getAuthentication().getAttributes().get(RememberMeCredential.AUTHENTICATION_ATTRIBUTE_REMEMBER_ME);
    if (b == null || b.equals(Boolean.FALSE)) {
      return this.sessionExpirationPolicy.isExpired(ticketState);
    }
    return this.rememberMeExpirationPolicy.isExpired(ticketState);
  }
  LOGGER.warn("No expiration policy settings are defined");
  return false;
}
