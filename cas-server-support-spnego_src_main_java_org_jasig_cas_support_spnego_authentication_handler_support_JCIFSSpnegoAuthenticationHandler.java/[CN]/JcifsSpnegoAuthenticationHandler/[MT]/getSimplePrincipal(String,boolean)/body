{
  if (this.principalWithDomainName) {
    return new SimplePrincipal(name);
  }
  if (isNtlm) {
    return Pattern.matches("\\S+\\\\\\S+",name) ? new SimplePrincipal(name.split("\\\\")[1]) : new SimplePrincipal(name);
  }
  return new SimplePrincipal(name.split("@")[0]);
}
