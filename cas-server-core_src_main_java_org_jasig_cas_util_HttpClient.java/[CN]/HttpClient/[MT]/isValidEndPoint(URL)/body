{
  HttpURLConnection connection=null;
  InputStream is=null;
  try {
    connection=(HttpURLConnection)url.openConnection();
    connection.setConnectTimeout(this.connectionTimeout);
    connection.setReadTimeout(this.readTimeout);
    connection.setInstanceFollowRedirects(this.followRedirects);
    if (connection instanceof HttpsURLConnection) {
      final HttpsURLConnection httpsConnection=(HttpsURLConnection)connection;
      if (this.sslSocketFactory != null) {
        httpsConnection.setSSLSocketFactory(this.sslSocketFactory);
      }
      if (this.hostnameVerifier != null) {
        httpsConnection.setHostnameVerifier(this.hostnameVerifier);
      }
    }
    connection.connect();
    final int responseCode=connection.getResponseCode();
    for (    final int acceptableCode : this.acceptableCodes) {
      if (responseCode == acceptableCode) {
        log.debug("Response code from server matched {}.",responseCode);
        return true;
      }
    }
    log.debug("Response Code did not match any of the acceptable response codes. Code returned was {}",responseCode);
    if (responseCode == 500) {
      is=connection.getInputStream();
      final String value=IOUtils.toString(is);
      log.error("There was an error contacting the endpoint: {}; The error was:\n{}",url.toExternalForm(),value);
    }
  }
 catch (  final IOException e) {
    log.error(e.getMessage(),e);
  }
 finally {
    IOUtils.closeQuietly(is);
    if (connection != null) {
      connection.disconnect();
    }
  }
  return false;
}
