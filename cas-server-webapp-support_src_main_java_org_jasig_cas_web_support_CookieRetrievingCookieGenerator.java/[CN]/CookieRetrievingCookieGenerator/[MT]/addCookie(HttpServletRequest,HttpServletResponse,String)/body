{
  final String encryptedCookieValue=encryptCookieValue(cookieValue);
  if (!StringUtils.hasText(request.getParameter(RememberMeCredential.REQUEST_PARAMETER_REMEMBER_ME))) {
    super.addCookie(response,encryptedCookieValue);
  }
 else {
    final Cookie cookie=createCookie(encryptedCookieValue);
    cookie.setMaxAge(this.rememberMeMaxAge);
    if (isCookieSecure()) {
      cookie.setSecure(true);
    }
    response.addCookie(cookie);
  }
}
