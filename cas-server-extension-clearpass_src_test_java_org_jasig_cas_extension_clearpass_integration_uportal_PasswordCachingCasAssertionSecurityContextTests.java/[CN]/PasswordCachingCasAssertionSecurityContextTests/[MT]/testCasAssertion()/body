{
  final MockPasswordCachingCasAssertionSecurityContext context=new MockPasswordCachingCasAssertionSecurityContext("http://localhost:8080/test","<cas:clearPassResponse xmlns:cas='http://www.yale.edu/tp/cas'>\n" + "<cas:clearPassSuccess> \n" + "<cas:credentials>XXX&amp;XXXX</cas:credentials> \n"+ "</cas:clearPassSuccess> \n"+ "</cas:clearPassResponse>");
  final AttributePrincipal attributePrincipal=mock(AttributePrincipal.class);
  when(attributePrincipal.getName()).thenReturn("test");
  when(attributePrincipal.getProxyTicketFor(Matchers.<String>any())).thenReturn("PT-158-74");
  final Assertion assertion=new AssertionImpl(attributePrincipal);
  try {
    AssertionHolder.setAssertion(assertion);
    context.authenticate();
  }
  finally {
    AssertionHolder.clear();
  }
}
