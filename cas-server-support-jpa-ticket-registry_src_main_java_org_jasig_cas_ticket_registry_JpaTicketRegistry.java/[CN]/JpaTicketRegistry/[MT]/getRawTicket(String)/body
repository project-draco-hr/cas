{
  try {
    if (ticketId.startsWith(TicketGrantingTicket.PREFIX) || ticketId.startsWith(ProxyGrantingTicket.PROXY_GRANTING_TICKET_PREFIX)) {
      return entityManager.find(TicketGrantingTicketImpl.class,ticketId,lockTgt ? LockModeType.PESSIMISTIC_WRITE : null);
    }
 else     if (ticketId.startsWith(OAuthCode.PREFIX) || ticketId.startsWith(AccessToken.PREFIX)) {
      return entityManager.find(OAuthCodeImpl.class,ticketId);
    }
    return entityManager.find(ServiceTicketImpl.class,ticketId);
  }
 catch (  final Exception e) {
    logger.error("Error getting ticket {} from registry.",ticketId,e);
  }
  return null;
}
