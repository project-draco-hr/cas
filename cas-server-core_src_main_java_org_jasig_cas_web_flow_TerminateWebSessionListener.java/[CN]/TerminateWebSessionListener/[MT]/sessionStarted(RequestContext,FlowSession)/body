{
  final Service service;
  try {
    service=WebUtils.getService(context);
  }
 catch (  IllegalStateException e) {
    logger.debug("Error getting service from flow state.",e);
    return;
  }
  if (service != null && service.getId().startsWith(serviceManagerUrl)) {
    final HttpSession webSession=WebUtils.getHttpServletRequest(context).getSession(false);
    if (webSession != null) {
      webSession.setAttribute(DO_NOT_TERMINATE,true);
    }
  }
}
