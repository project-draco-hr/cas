{
  final String metadataLocation=service.getMetadataLocation();
  LOGGER.info("Loading SAML metadata from [{}]",metadataLocation);
  final AbstractResource metadataResource=ResourceUtils.getResourceFrom(metadataLocation);
  try (final InputStream in=metadataResource.getInputStream()){
    LOGGER.debug("Parsing metadata from [{}]",metadataLocation);
    final Document document=configBean.getParserPool().parse(in);
    final List<MetadataResolver> resolvers=buildSingleMetadataResolver(document,service);
    final ChainingMetadataResolver metadataResolver=new ChainingMetadataResolver();
synchronized (this.lock) {
      metadataResolver.setId(ChainingMetadataResolver.class.getCanonicalName());
      metadataResolver.setResolvers(resolvers);
      metadataResolver.initialize();
    }
    return metadataResolver;
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
}
