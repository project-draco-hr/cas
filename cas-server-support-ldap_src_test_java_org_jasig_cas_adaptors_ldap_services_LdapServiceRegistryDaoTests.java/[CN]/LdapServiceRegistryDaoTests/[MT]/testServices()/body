{
  assertEquals(0,this.dao.load().size());
  AbstractRegisteredService rs=new RegisteredServiceImpl();
  rs.setName("Service Name1");
  rs.setAllowedToProxy(false);
  rs.setAnonymousAccess(true);
  rs.setDescription("Service description");
  rs.setServiceId("https://?.edu/**");
  rs.setTheme("the theme name");
  rs.setUsernameAttribute("uid");
  rs.setEvaluationOrder(123);
  rs.setAttributeFilteringPolicy(new ReturnAllAttributeFilteringPolicy());
  this.dao.save(rs);
  rs=new RegexRegisteredService();
  rs.setName("Service Name Regex");
  rs.setAllowedToProxy(false);
  rs.setAnonymousAccess(true);
  rs.setDescription("Service description");
  rs.setServiceId("^http?://.+");
  rs.setTheme("the theme name");
  rs.setUsernameAttribute("uid");
  rs.setEvaluationOrder(123);
  rs.setRequiredHandlers(new HashSet<String>(Arrays.asList("handler1","handler2")));
  this.dao.save(rs);
  final List<RegisteredService> services=this.dao.load();
  assertEquals(2,services.size());
  AbstractRegisteredService rs2=(AbstractRegisteredService)this.dao.findServiceById(services.get(0).getId());
  assertNotNull(rs2);
  rs2.setEvaluationOrder(9999);
  rs2.setName("Another Test Service");
  rs2=(AbstractRegisteredService)this.dao.save(rs2);
  assertNotNull(rs2);
  for (  final RegisteredService registeredService : services) {
    this.dao.delete(registeredService);
  }
  assertEquals(0,this.dao.load().size());
}
