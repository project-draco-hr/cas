{
  try {
    if (this.registeredService.getPublicKey() == null) {
      LOGGER.debug("No public key is defined for service [{}]. No encoding will take place.",this.registeredService);
      return null;
    }
    final PublicKey publicKey=this.registeredService.getPublicKey().createInstance();
    if (publicKey == null) {
      LOGGER.debug("No public key instance created for service [{}]. No encoding will take place.",this.registeredService);
      return null;
    }
    LOGGER.debug("Using public key [{}] to initialize the cipher",this.registeredService.getPublicKey());
    final Cipher cipher=Cipher.getInstance(publicKey.getAlgorithm());
    cipher.init(Cipher.ENCRYPT_MODE,publicKey);
    LOGGER.debug("Initialized cipher in encrypt-mode via the public key algorithm [{}]",publicKey.getAlgorithm());
    return cipher;
  }
 catch (  final Exception e) {
    LOGGER.warn("Cipher could not be initialized for service [{}]. Error " + e.getMessage(),registeredService);
  }
  return null;
}
