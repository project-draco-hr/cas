{
  if (StringUtils.isBlank(clientId)) {
    logger.error("Missing {}",OAuthConstants.CLIENT_ID);
    return false;
  }
  if (StringUtils.isBlank(redirectUri)) {
    logger.error("Missing {}",OAuthConstants.REDIRECT_URI);
    return false;
  }
  if (StringUtils.isBlank(clientSecret)) {
    logger.error("Missing {}",OAuthConstants.CLIENT_SECRET);
    return false;
  }
  if (StringUtils.isBlank(code)) {
    logger.error("Missing {}",OAuthConstants.CODE);
    return false;
  }
  final OAuthRegisteredService service=OAuthUtils.getRegisteredOAuthService(this.servicesManager,clientId);
  if (service == null) {
    logger.error("Unknown {} : {}",OAuthConstants.CLIENT_ID,clientId);
    return false;
  }
  final String serviceId=service.getServiceId();
  if (!redirectUri.matches(serviceId)) {
    logger.error("Unsupported {} : {} for serviceId : {}",OAuthConstants.REDIRECT_URI,redirectUri,serviceId);
    return false;
  }
  if (!StringUtils.equals(service.getClientSecret(),clientSecret)) {
    logger.error("Wrong client secret for service {}",service);
    return false;
  }
  return true;
}
