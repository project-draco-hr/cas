{
  final Optional<UsernamePasswordCredentials> opCredentials=getCredentials(request);
  if (!opCredentials.isPresent()) {
    logger.error("Missing credentials");
    return false;
  }
  final UsernamePasswordCredentials credentials=opCredentials.get();
  if (StringUtils.isBlank(credentials.getUsername())) {
    logger.error("Missing clientId");
    return false;
  }
 else   if (StringUtils.isBlank(credentials.getPassword())) {
    logger.error("Missing secret");
    return false;
  }
  return true;
}
