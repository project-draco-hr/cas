{
  this.id=id;
  final CredentialMetaData credentialMetaData=new BasicCredentialMetaData(credential);
  final AuthenticationBuilder builder=new AuthenticationBuilder();
  final Map<String,Object> attributes=new HashMap<>();
  attributes.put("nickname","bob");
  builder.setPrincipal(this.principalFactory.createPrincipal("handymanbob",attributes));
  builder.setAuthenticationDate(new Date());
  builder.addCredential(credentialMetaData);
  final AuthenticationHandler handler=new MockAuthenticationHandler();
  try {
    builder.addSuccess(handler.getName(),handler.authenticate(credential));
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
  builder.addFailure(handler.getName(),FailedLoginException.class);
  this.authentication=builder.build();
}
