{
  if (!"POST".equals(request.getMethod())) {
    return;
  }
  final RequestContext context=(RequestContext)request.getAttribute("flowRequestContext");
  if (context == null || context.getCurrentEvent() == null) {
    return;
  }
  if (SUCCESSFUL_AUTHENTICATION_EVENT.equals(context.getCurrentEvent().getId())) {
    return;
  }
  recordSubmissionFailure(request);
}
