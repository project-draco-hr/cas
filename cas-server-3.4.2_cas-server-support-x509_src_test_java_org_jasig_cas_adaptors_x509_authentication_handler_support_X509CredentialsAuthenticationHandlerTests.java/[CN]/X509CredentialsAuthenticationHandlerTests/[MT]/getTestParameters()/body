{
  final Collection<Object[]> params=new ArrayList<Object[]>();
  X509CredentialsAuthenticationHandler handler;
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  params.add(new Object[]{handler,new UsernamePasswordCredentials(),false,false});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid.crt")),true,true});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-expired.crt")),true,false});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern("CN=\\w+,OU=CAS,O=Jasig,L=Westminster,ST=Colorado,C=US");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("snake-oil.crt")),true,false});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  handler.setSubjectDnPattern("CN=\\w+,OU=CAS,O=Jasig,L=Westminster,ST=Colorado,C=US");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("snake-oil.crt")),true,false});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  handler.setCheckKeyUsage(true);
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid.crt")),true,true});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  handler.setCheckKeyUsage(true);
  handler.setRequireKeyUsage(true);
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid.crt")),true,false});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  handler.setCheckKeyUsage(true);
  handler.setRequireKeyUsage(true);
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid-keyUsage.crt")),true,true});
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  handler.setCheckKeyUsage(true);
  handler.setRequireKeyUsage(true);
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-invalid-keyUsage.crt")),true,false});
  ResourceCRLRevocationChecker checker;
  handler=new X509CredentialsAuthenticationHandler();
  checker=new ResourceCRLRevocationChecker(new ClassPathResource("userCA-valid.crl"));
  checker.afterPropertiesSet();
  handler.setRevocationChecker(checker);
  handler.setTrustedIssuerDnPattern(".*");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid.crt")),true,true});
  handler=new X509CredentialsAuthenticationHandler();
  checker=new ResourceCRLRevocationChecker(new ClassPathResource("userCA-valid.crl"));
  checker.afterPropertiesSet();
  handler.setRevocationChecker(checker);
  handler.setTrustedIssuerDnPattern(".*");
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-revoked.crt")),true,false});
  final ThresholdExpiredCRLRevocationPolicy zeroThresholdPolicy=new ThresholdExpiredCRLRevocationPolicy();
  zeroThresholdPolicy.setThreshold(0);
  handler=new X509CredentialsAuthenticationHandler();
  handler.setTrustedIssuerDnPattern(".*");
  checker=new ResourceCRLRevocationChecker(new ClassPathResource("userCA-expired.crl"));
  checker.setExpiredCRLPolicy(zeroThresholdPolicy);
  checker.afterPropertiesSet();
  handler.setRevocationChecker(checker);
  params.add(new Object[]{handler,new X509CertificateCredentials(createCertificates("user-valid.crt")),true,false});
  return params;
}
