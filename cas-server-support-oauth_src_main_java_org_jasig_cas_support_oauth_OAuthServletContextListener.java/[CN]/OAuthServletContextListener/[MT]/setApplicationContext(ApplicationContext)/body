{
  try {
    if (applicationContext.getParent() != null) {
      logger.info("Initializing OAuth application context");
      final SimpleUrlHandlerMapping handlerMappingC=applicationContext.getBean("handlerMappingC",SimpleUrlHandlerMapping.class);
      final Controller controller=applicationContext.getBean("oauth20WrapperController",Controller.class);
      final Map<String,Object> urlMap=(Map<String,Object>)handlerMappingC.getUrlMap();
      urlMap.put(OAuthConstants.ENDPOINT_OAUTH2,controller);
      handlerMappingC.initApplicationContext();
      final OAuthCallbackAuthorizeService service=new OAuthCallbackAuthorizeService();
      service.setId(new SecureRandom().nextLong());
      service.setName(service.getClass().getSimpleName());
      service.setDescription("OAuth Wrapper Callback Url");
      service.setServiceId(this.callbackAuthorizeUrl);
      this.servicesManager.save(service);
      logger.info("Initialized OAuth application context successfully");
    }
  }
 catch (  final Exception e) {
    logger.error(e.getMessage(),e);
  }
}
