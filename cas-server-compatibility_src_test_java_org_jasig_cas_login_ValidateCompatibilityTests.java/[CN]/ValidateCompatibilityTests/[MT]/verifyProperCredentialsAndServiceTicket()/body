{
  final String service="http://www.cnn.com";
  beginAt("/login?service=" + URLEncoder.encode(service,"UTF-8"));
  setFormElement("username",getUsername());
  setFormElement("password",getGoodPassword());
  submit();
  HttpUnitDialog htDialog=getDialog();
  final String serviceTicket=LoginHelper.serviceTicketFromResponse(htDialog.getResponse());
  beginAt("/validate?service=" + URLEncoder.encode(service,"UTF-8") + "&ticket="+ serviceTicket);
  assertTextPresent("yes");
  htDialog=getDialog();
  final String validateOutput=htDialog.getResponseText();
  final String expected="yes\n" + getUsername() + "\n";
  assertEquals(expected,validateOutput);
  beginAt("/validate?service=" + URLEncoder.encode(service,"UTF-8") + "&ticket="+ serviceTicket);
  htDialog=getDialog();
  final String secondValidateOutput=htDialog.getResponseText();
  assertEquals(LEGACY_NO_RESPONSE,secondValidateOutput);
}
