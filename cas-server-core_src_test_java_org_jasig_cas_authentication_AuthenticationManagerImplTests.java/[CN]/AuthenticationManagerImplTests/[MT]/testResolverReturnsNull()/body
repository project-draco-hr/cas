{
  AuthenticationManagerImpl manager=new AuthenticationManagerImpl();
  HttpBasedServiceCredentialsAuthenticationHandler authenticationHandler=new HttpBasedServiceCredentialsAuthenticationHandler();
  authenticationHandler.setHttpClient(new HttpClient());
  manager.setAuthenticationHandlers(handlerList(authenticationHandler));
  manager.setCredentialsToPrincipalResolvers(Arrays.asList((CredentialsToPrincipalResolver)new TestCredentialsToPrincipalResolver()));
  manager.authenticate(TestUtils.getHttpBasedServiceCredentials());
}
