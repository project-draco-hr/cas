{
  final ParameterList parameters=new ParameterList(request.getParameterMap());
  final String mode=parameters.hasParameter("openid.mode") ? parameters.getParameterValue("openid.mode") : null;
  Message response=null;
  if (StringUtils.equals(mode,ASSOCIATE)) {
    response=serverManager.associationResponse(parameters);
  }
  final Map<String,String> responseParams=new HashMap<>();
  if (response != null) {
    responseParams.putAll(response.getParameterMap());
  }
  return responseParams;
}
