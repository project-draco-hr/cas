{
  final RequestContext requestContext=RequestContextHolder.getRequestContext();
  final WebApplicationService service=(WebApplicationService)WebUtils.getService(requestContext);
  final RegisteredService registeredService=this.servicesManager.findServiceBy(service);
  final String themeId=service != null && registeredService != null && StringUtils.hasText(registeredService.getTheme()) ? registeredService.getTheme() : defaultThemeId;
  final String prefix=String.format("%s/%s/ui/",pathPrefix,themeId);
  LOGGER.debug("Prefix {} set for service {} with theme {}",prefix,service,themeId);
  super.setPrefix(prefix);
  final AbstractUrlBasedView view=super.buildView(viewName);
  LOGGER.debug("View resolved: {}",view.getUrl());
  return view;
}
