{
  final Map<String,String> initParams=new HashMap<>();
  initParams.put(RequestParameterPolicyEnforcementFilter.PARAMETERS_TO_CHECK,this.paramsToCheck);
  initParams.put(RequestParameterPolicyEnforcementFilter.CHARACTERS_TO_FORBID,"none");
  initParams.put(RequestParameterPolicyEnforcementFilter.ALLOW_MULTI_VALUED_PARAMETERS,BooleanUtils.toStringTrueFalse(this.allowMultiValueParameters));
  initParams.put(RequestParameterPolicyEnforcementFilter.ONLY_POST_PARAMETERS,this.onlyPostParams);
  final FilterRegistrationBean bean=new FilterRegistrationBean();
  bean.setFilter(new RequestParameterPolicyEnforcementFilter());
  bean.setUrlPatterns(Collections.singleton("/*"));
  bean.setName("requestParameterSecurityFilter");
  bean.setInitParameters(initParams);
  return bean;
}
