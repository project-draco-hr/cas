{
  try {
    final MarshallerFactory marshallerFactory=Configuration.getMarshallerFactory();
    final Marshaller marshaller=marshallerFactory.getMarshaller(object);
    final Element element=marshaller.marshall(object);
    final TransformerFactory transFactory=TransformerFactory.newInstance();
    final Transformer transformer=transFactory.newTransformer();
    transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION,"yes");
    transformer.transform(new DOMSource(element),new StreamResult(writer));
    return writer.toString();
  }
 catch (  final Exception e) {
    throw new IllegalStateException("An error has occurred while marshalling SAML object to xml",e);
  }
}
