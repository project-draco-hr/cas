{
  log.debug("Obtaining credentials...");
  final Credential c=obtainCredentials();
  try {
    final String ticketGrantingTicketId=this.centralAuthenticationService.createTicketGrantingTicket(c);
    getResponse().setStatus(determineStatus());
    final Reference ticket_ref=getRequest().getResourceRef().addSegment(ticketGrantingTicketId);
    getResponse().setLocationRef(ticket_ref);
    getResponse().setEntity("<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\"><html><head><title>" + getResponse().getStatus().getCode() + " "+ getResponse().getStatus().getDescription()+ "</title></head><body><h1>TGT Created</h1><form action=\""+ ticket_ref+ "\" method=\"POST\">Service:<input type=\"text\" name=\"service\" value=\"\"><br><input type=\"submit\" value=\"Submit\"></form></body></html>",MediaType.TEXT_HTML);
  }
 catch (  final Exception e) {
    log.error(e.getMessage(),e);
    getResponse().setStatus(Status.CLIENT_ERROR_BAD_REQUEST,e.getMessage());
  }
}
