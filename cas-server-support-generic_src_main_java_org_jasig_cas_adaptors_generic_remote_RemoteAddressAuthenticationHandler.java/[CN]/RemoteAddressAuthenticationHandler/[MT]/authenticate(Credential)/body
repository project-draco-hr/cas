{
  final RemoteAddressCredential c=(RemoteAddressCredential)credential;
  try {
    final InetAddress inetAddress=InetAddress.getByName(c.getRemoteAddress().trim());
    if (containsAddress(this.inetNetwork,this.inetNetmask,inetAddress)) {
      return new HandlerResult(this,c,new SimplePrincipal(c.getId()));
    }
  }
 catch (  final UnknownHostException e) {
    logger.debug("Unknown host {}",c.getRemoteAddress());
  }
  throw new FailedLoginException(c.getRemoteAddress() + " not in allowed range.");
}
