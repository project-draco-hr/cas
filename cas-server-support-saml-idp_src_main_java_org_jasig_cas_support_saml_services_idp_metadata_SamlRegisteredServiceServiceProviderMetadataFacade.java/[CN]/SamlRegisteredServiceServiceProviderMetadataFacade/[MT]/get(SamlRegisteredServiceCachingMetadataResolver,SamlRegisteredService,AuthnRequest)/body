{
  try {
    final AssertionConsumerService assertionConsumerService=SamlIdPUtils.getAssertionConsumerServiceFor(authnRequest);
    final CriteriaSet criterions=new CriteriaSet();
    criterions.add(new EndpointCriterion<>(assertionConsumerService,true));
    LOGGER.info("Locating metadata for entityID [{}], with binding [{}] and ACS endpoint [{}]",authnRequest.getIssuer().getValue(),SAMLConstants.SAML2_POST_BINDING_URI,assertionConsumerService.getLocation());
    return get(resolver,registeredService,authnRequest.getIssuer().getValue(),criterions);
  }
 catch (  final Exception e) {
    throw new RuntimeException(e.getMessage(),e);
  }
}
