{
  initDirectoryServer();
  getDirectory().populateEntries(new ClassPathResource("ldif/users-x509.ldif").getInputStream());
  final Collection<LdapEntry> col=getDirectory().getLdapEntries();
  for (  final LdapEntry ldapEntry : col) {
    if (ldapEntry.getDn().equals(DN)) {
      final LdapAttribute attr=new LdapAttribute(true);
      byte[] value=new byte[1024];
      IOUtils.read(new ClassPathResource("userCA-valid.crl").getInputStream(),value);
      value=CompressionUtils.encodeBase64ToByteArray(value);
      attr.setName("certificateRevocationList");
      attr.addBinaryValue(value);
      final LDAPConnection serverCon=getDirectory().getConnection();
      final String address="ldap://" + serverCon.getConnectedAddress() + ":"+ serverCon.getConnectedPort();
      final Connection conn=DefaultConnectionFactory.getConnection(address);
      conn.open();
      final ModifyOperation modify=new ModifyOperation(conn);
      modify.execute(new ModifyRequest(ldapEntry.getDn(),new AttributeModification(AttributeModificationType.ADD,attr)));
      conn.close();
      serverCon.close();
      return;
    }
  }
}
