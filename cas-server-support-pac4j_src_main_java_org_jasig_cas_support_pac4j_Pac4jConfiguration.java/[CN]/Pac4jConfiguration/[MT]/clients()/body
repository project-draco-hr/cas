{
  final List<Client> allClients=new ArrayList<>();
  final Map<String,String> properties=new HashMap<>();
  final Enumeration names=casProperties.propertyNames();
  while (names.hasMoreElements()) {
    final String name=(String)names.nextElement();
    if (name.startsWith(CAS_PAC4J_PREFIX)) {
      properties.put(name.substring(CAS_PAC4J_PREFIX.length()),casProperties.getProperty(name));
    }
  }
  final ConfigFactory configFactory=new PropertiesConfigFactory(properties);
  final Config propertiesConfig=configFactory.build();
  allClients.addAll(propertiesConfig.getClients().getClients());
  if (clients != null && clients.length > 0) {
    allClients.addAll(Arrays.<Client>asList(clients));
  }
  if (allClients.isEmpty()) {
    throw new IllegalArgumentException("At least one pac4j client must be defined");
  }
  return new Clients(serverLoginUrl,allClients);
}
