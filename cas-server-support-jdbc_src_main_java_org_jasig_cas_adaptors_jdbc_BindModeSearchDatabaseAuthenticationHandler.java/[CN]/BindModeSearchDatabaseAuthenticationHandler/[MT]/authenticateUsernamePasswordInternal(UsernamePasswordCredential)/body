{
  try {
    final Connection c=this.getDataSource().getConnection(credential.getUsername(),credential.getPassword());
    DataSourceUtils.releaseConnection(c,this.getDataSource());
    return createHandlerResult(credential,new SimplePrincipal(credential.getUsername()),null);
  }
 catch (  final SQLException e) {
    throw new FailedLoginException(e.getMessage());
  }
catch (  final Exception e) {
    throw new PreventedException("Unexpected SQL connection error",e);
  }
}
