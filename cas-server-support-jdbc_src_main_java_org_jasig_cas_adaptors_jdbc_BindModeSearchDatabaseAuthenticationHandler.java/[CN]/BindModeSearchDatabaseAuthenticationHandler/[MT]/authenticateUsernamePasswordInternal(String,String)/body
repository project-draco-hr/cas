{
  try {
    final Connection c=this.getDataSource().getConnection(username,password);
    DataSourceUtils.releaseConnection(c,this.getDataSource());
    return new SimplePrincipal(username);
  }
 catch (  final SQLException e) {
    throw new FailedLoginException(e.getMessage());
  }
catch (  final Exception e) {
    throw new PreventedException("Unexpected SQL connection error",e);
  }
}
