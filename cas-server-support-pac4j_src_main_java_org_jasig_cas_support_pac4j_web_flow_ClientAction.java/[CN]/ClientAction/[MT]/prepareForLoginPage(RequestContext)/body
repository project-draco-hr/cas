{
  final HttpServletRequest request=WebUtils.getHttpServletRequest(context);
  final HttpServletResponse response=WebUtils.getHttpServletResponse(context);
  final HttpSession session=request.getSession();
  final WebContext webContext=new J2EContext(request,response);
  final WebApplicationService service=WebUtils.getService(context);
  logger.debug("save service: {}",service);
  session.setAttribute(CasProtocolConstants.PARAMETER_SERVICE,service);
  saveRequestParameter(request,session,ThemeChangeInterceptor.DEFAULT_PARAM_NAME);
  saveRequestParameter(request,session,LocaleChangeInterceptor.DEFAULT_PARAM_NAME);
  saveRequestParameter(request,session,CasProtocolConstants.PARAMETER_METHOD);
  final Set<ProviderLoginPageConfiguration> urls=new LinkedHashSet<>();
  for (  final Client client : this.clients.findAllClients()) {
    final IndirectClient indirectClient=(IndirectClient)client;
    final String redirectionUrl=indirectClient.getRedirectionUrl(webContext);
    String name=StringUtils.remove(client.getName(),"Client");
    if (this.applicationContext != null) {
      name=this.applicationContext.getMessage(Pac4jConfiguration.CAS_PAC4J_PREFIX.concat('.' + name.toLowerCase()),null,name,request.getLocale());
    }
    logger.debug("{} -> {}",name,redirectionUrl);
    urls.add(new ProviderLoginPageConfiguration(name,redirectionUrl,name.toLowerCase()));
  }
  context.getFlowScope().put(PAC4J_URLS,urls);
}
