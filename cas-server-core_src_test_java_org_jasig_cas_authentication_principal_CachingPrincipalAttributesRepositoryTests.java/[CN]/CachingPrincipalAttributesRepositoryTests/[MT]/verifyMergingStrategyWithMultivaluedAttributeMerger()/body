{
  final CachingPrincipalAttributesRepository repository=new CachingPrincipalAttributesRepository(this.dao,TimeUnit.SECONDS,5);
  repository.setMergingStrategy(new MultivaluedAttributeMerger());
  assertTrue(repository.getAttributes(this.principal).get("mail") instanceof List);
  final List<?> values=(List)repository.getAttributes(this.principal).get("mail");
  assertTrue(values.contains("final@example.com"));
  assertTrue(values.contains("final@school.com"));
  ((Closeable)repository).close();
}
