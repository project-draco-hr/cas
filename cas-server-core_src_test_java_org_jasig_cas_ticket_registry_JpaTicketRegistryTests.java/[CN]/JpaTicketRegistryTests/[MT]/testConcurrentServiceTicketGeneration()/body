{
  final TicketGrantingTicket newTgt=newTGT();
  addTicketInTransaction(newTgt);
  final ExecutorService executor=Executors.newFixedThreadPool(CONCURRENT_SIZE);
  try {
    final List<ServiceTicketGenerator> generators=new ArrayList<ServiceTicketGenerator>(CONCURRENT_SIZE);
    for (int i=0; i < CONCURRENT_SIZE; i++) {
      generators.add(new ServiceTicketGenerator(newTgt.getId()));
    }
    final List<Future<String>> results=executor.invokeAll(generators);
    for (    Future<String> result : results) {
      assertNotNull(result.get());
    }
  }
 catch (  Exception e) {
    log.debug("testConcurrentServiceTicketGeneration produced an error",e);
    fail("testConcurrentServiceTicketGeneration failed.");
  }
 finally {
    executor.shutdownNow();
  }
}
