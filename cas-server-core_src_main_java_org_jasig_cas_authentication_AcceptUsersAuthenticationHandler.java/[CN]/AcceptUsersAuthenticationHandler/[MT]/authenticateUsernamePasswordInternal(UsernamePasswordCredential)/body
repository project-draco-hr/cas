{
  final String cachedPassword=this.users.get(credential.getUsername());
  if (cachedPassword == null) {
    logger.debug("{} was not found in the map.",credential.getUsername());
    throw new AccountNotFoundException(credential.getUsername() + " not found in backing map.");
  }
  final String encodedPassword=this.getPasswordEncoder().encode(credential.getPassword());
  if (!cachedPassword.equals(encodedPassword)) {
    throw new FailedLoginException();
  }
  return createHandlerResult(credential,new SimplePrincipal(credential.getUsername()),null);
}
