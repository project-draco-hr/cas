{
  final String cachedPassword=this.users.get(username);
  if (cachedPassword == null) {
    logger.debug("{} was not found in the map.",username);
    throw new AccountNotFoundException(username + " not found in backing map.");
  }
  final String encodedPassword=this.getPasswordEncoder().encode(password);
  if (!cachedPassword.equals(encodedPassword)) {
    throw new FailedLoginException();
  }
  return new SimplePrincipal(username);
}
