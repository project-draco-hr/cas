{
  final IPersonAttributes attrs=this.attributeRepository.getPerson(id);
  if (attrs == null) {
    return Collections.emptyMap();
  }
  final Map<String,List<Object>> attributes=attrs.getAttributes();
  if (attributes == null) {
    return Collections.emptyMap();
  }
  final Map<String,Object> convertedAttributes=new HashMap<String,Object>();
  for (  final Map.Entry<String,List<Object>> entry : attributes.entrySet()) {
    final List<Object> values=entry.getValue();
    convertedAttributes.put(entry.getKey(),values.size() == 1 ? values.get(0) : values);
  }
  return convertedAttributes;
}
