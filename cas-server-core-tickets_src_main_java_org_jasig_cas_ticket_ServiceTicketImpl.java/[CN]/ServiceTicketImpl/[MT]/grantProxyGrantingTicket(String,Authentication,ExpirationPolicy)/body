{
synchronized (this.lock) {
    if (this.grantedTicketAlready) {
      throw new InvalidProxyGrantingTicketForServiceTicket(service);
    }
    this.grantedTicketAlready=Boolean.TRUE;
  }
  final ProxyGrantingTicket pgt=new ProxyGrantingTicketImpl(id,service,this.getGrantingTicket(),authentication,expirationPolicy);
  getGrantingTicket().getProxyGrantingTickets().add(pgt);
  return pgt;
}
