{
  if (value == null) {
    return null;
  }
  try {
    final Cipher cipher=getCipherObject();
    byte[] iv=generateIV();
    IvParameterSpec ivSpec=new IvParameterSpec(iv);
    cipher.init(Cipher.ENCRYPT_MODE,this.key,ivSpec);
    byte[] ciphertext=cipher.doFinal(value.getBytes());
    byte[] iv_ciphertext=new byte[iv.length + ciphertext.length];
    System.arraycopy(iv,0,iv_ciphertext,0,iv.length);
    System.arraycopy(ciphertext,0,iv_ciphertext,iv.length,ciphertext.length);
    return new String(encode(iv_ciphertext));
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
}
