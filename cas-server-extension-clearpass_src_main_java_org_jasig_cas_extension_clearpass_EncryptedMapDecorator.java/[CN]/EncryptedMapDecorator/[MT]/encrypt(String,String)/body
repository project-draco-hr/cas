{
  if (value == null) {
    return null;
  }
  try {
    final Cipher cipher=getCipherObject();
    final byte[] ivValue=generateIV(this.ivSize);
    final IvParameterSpec ivSpec=new IvParameterSpec(ivValue);
    cipher.init(Cipher.ENCRYPT_MODE,this.key,ivSpec);
    final byte[] ciphertext=cipher.doFinal(value.getBytes(Charset.defaultCharset()));
    final byte[] ivCiphertext=new byte[INTEGER_LEN + this.ivSize + ciphertext.length];
    System.arraycopy(int2byte(this.ivSize),0,ivCiphertext,0,INTEGER_LEN);
    System.arraycopy(ivValue,0,ivCiphertext,INTEGER_LEN,this.ivSize);
    System.arraycopy(ciphertext,0,ivCiphertext,INTEGER_LEN + this.ivSize,ciphertext.length);
    return CompressionUtils.encodeBase64(ivCiphertext);
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
}
