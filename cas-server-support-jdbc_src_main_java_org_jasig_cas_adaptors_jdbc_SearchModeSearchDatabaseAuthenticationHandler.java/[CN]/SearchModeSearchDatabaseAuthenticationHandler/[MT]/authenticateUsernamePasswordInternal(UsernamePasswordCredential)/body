{
  final String encyptedPassword=getPasswordEncoder().encode(credential.getPassword());
  final int count;
  try {
    count=getJdbcTemplate().queryForObject(this.sql,Integer.class,credential.getUsername(),encyptedPassword);
  }
 catch (  final DataAccessException e) {
    throw new PreventedException("SQL exception while executing query for " + credential.getUsername(),e);
  }
  if (count == 0) {
    throw new FailedLoginException(credential.getUsername() + " not found with SQL query.");
  }
  return createHandlerResult(credential,new SimplePrincipal(credential.getUsername()),null);
}
