{
  final List<TicketGrantingTicketImpl> ticketGrantingTicketImpls=entityManager.createQuery("select t from TicketGrantingTicketImpl t where t.ticketGrantingTicket.id = :id",TicketGrantingTicketImpl.class).setLockMode(LockModeType.PESSIMISTIC_WRITE).setParameter("id",ticket.getId()).getResultList();
  final List<ServiceTicketImpl> serviceTicketImpls=entityManager.createQuery("select s from ServiceTicketImpl s where s.ticketGrantingTicket.id = :id",ServiceTicketImpl.class).setParameter("id",ticket.getId()).getResultList();
  for (  final ServiceTicketImpl s : serviceTicketImpls) {
    removeTicket(s);
  }
  for (  final TicketGrantingTicketImpl t : ticketGrantingTicketImpls) {
    deleteTicketAndChildren(t);
  }
  removeTicket(ticket);
}
