{
  try {
    if (service.isSignAssertions()) {
      this.samlObjectEncoder.encode(assertion,service,adaptor,response,request);
    }
  }
 catch (  final Exception e) {
    logger.error("Unable to marshall assertion for signing",e);
    throw new SamlException("Unable to marshall assertion for signing",e);
  }
}
