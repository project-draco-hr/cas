{
  final String service=request.getParameter(CONST_PARAM_SERVICE);
  final String artifactId;
  final String requestBody=getRequestBody(request);
  final String requestId;
  if (!StringUtils.hasText(service) && !StringUtils.hasText(requestBody)) {
    return null;
  }
  final String id=cleanupUrl(service);
  if (StringUtils.hasText(requestBody)) {
    final int startTagLocation=requestBody.indexOf(CONST_START_ARTIFACT_XML_TAG);
    final int artifactStartLocation=startTagLocation + CONST_START_ARTIFACT_XML_TAG.length();
    final int endTagLocation=requestBody.indexOf(CONST_END_ARTIFACT_XML_TAG);
    artifactId=requestBody.substring(artifactStartLocation,endTagLocation).trim();
    requestId=extractRequestId(requestBody);
  }
 else {
    artifactId=null;
    requestId=null;
  }
  if (log.isDebugEnabled()) {
    log.debug("Attempted to extract Request from HttpServletRequest.  Results:");
    log.debug(String.format("Request Body: %s",requestBody));
    log.debug(String.format("Extracted ArtifactId: %s",artifactId));
    log.debug(String.format("Extracted Request Id: %s",requestId));
  }
  return new SamlService(id,service,artifactId,httpClient,requestId);
}
