{
  final OpenIdCredentials c=(OpenIdCredentials)credentials;
  boolean result=false;
  final TicketGrantingTicket t=(TicketGrantingTicket)this.ticketRegistry.getTicket(c.getTicketGrantingTicketId(),TicketGrantingTicket.class);
  if (t == null || t.isExpired()) {
    result=false;
  }
 else {
    result=t.getAuthentication().getPrincipal().getId().equals(c.getUsername());
  }
  return result;
}
