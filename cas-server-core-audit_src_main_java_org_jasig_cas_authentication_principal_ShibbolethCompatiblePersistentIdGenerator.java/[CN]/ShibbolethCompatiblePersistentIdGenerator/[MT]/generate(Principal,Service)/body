{
  try {
    final MessageDigest md=MessageDigest.getInstance("SHA");
    final Charset charset=Charset.defaultCharset();
    md.update(service.getId().getBytes(charset));
    md.update(CONST_SEPARATOR);
    md.update(principal.getId().getBytes(charset));
    md.update(CONST_SEPARATOR);
    final String result=CompressionUtils.encodeBase64(md.digest(this.salt));
    return result.replaceAll(System.getProperty("line.separator"),"");
  }
 catch (  final NoSuchAlgorithmException e) {
    throw new RuntimeException(e);
  }
}
