{
  final UsernamePasswordCredential userPass=(UsernamePasswordCredential)credential;
  if (userPass.getUsername() == null) {
    throw new AccountNotFoundException("Username is null.");
  }
  final String transformedUsername=this.principalNameTransformer.transform(userPass.getUsername());
  if (transformedUsername == null) {
    throw new AccountNotFoundException("Transformed username is null.");
  }
  userPass.setUsername(transformedUsername);
  return authenticateUsernamePasswordInternal(userPass);
}
