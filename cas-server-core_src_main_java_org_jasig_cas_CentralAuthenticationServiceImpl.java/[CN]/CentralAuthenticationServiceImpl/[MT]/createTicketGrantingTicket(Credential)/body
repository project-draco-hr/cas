{
  final Set<Credential> sanitizedCredentials=sanitizeCredentials(credentials);
  if (!sanitizedCredentials.isEmpty()) {
    final Authentication authentication=this.authenticationManager.authenticate(credentials);
    final TicketGrantingTicketFactory factory=this.ticketFactory.get(TicketGrantingTicket.class);
    final TicketGrantingTicket ticketGrantingTicket=factory.create(authentication);
    this.ticketRegistry.addTicket(ticketGrantingTicket);
    doPublishEvent(new CasTicketGrantingTicketCreatedEvent(this,ticketGrantingTicket));
    return ticketGrantingTicket;
  }
  final String msg="No credentials were specified in the request for creating a new ticket-granting ticket";
  logger.warn(msg);
  throw new TicketCreationException(new IllegalArgumentException(msg));
}
