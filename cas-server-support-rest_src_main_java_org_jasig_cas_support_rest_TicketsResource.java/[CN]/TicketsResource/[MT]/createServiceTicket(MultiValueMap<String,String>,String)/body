{
  try {
    final String serviceId=requestBody.getFirst(CasProtocolConstants.PARAMETER_SERVICE);
    final AuthenticationContext authenticationContext=this.authenticationTransactionManager.build();
    final ServiceTicket serviceTicketId=this.cas.grantServiceTicket(tgtId,this.webApplicationServiceFactory.createService(serviceId),authenticationContext);
    return new ResponseEntity<>(serviceTicketId.getId(),HttpStatus.OK);
  }
 catch (  final InvalidTicketException e) {
    return new ResponseEntity<>("TicketGrantingTicket could not be found",HttpStatus.NOT_FOUND);
  }
catch (  final Exception e) {
    LOGGER.error(e.getMessage(),e);
    return new ResponseEntity<>(e.getMessage(),HttpStatus.INTERNAL_SERVER_ERROR);
  }
}
