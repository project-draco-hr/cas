{
  String username=this.identifier;
  if (log.isInfoEnabled()) {
    log.info("Creating principal for: " + certificate.getSubjectDN().getName());
  }
  final String[] entries=certificate.getSubjectDN().getName().split(ENTRIES_DELIMITER);
  Arrays.sort(entries,new LengthComparator());
  for (  final String val : entries) {
    final String[] nameValuePair=val.split(NAME_VALUE_PAIR_DELIMITER);
    final String name=nameValuePair[0].trim();
    final String value=nameValuePair[1];
    if (log.isDebugEnabled()) {
      log.debug("Parsed " + name + " - "+ value);
    }
    username=username.replaceAll("\\$" + name,value);
  }
  if (this.identifier.equals(username)) {
    return null;
  }
  return username;
}
