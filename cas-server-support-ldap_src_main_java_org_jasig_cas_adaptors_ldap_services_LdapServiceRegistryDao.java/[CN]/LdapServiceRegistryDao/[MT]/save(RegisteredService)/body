{
  if (rs.getId() != -1) {
    return update(rs);
  }
  Connection connection=null;
  try {
    connection=this.connectionFactory.getConnection();
    final AddOperation operation=new AddOperation(connection);
    final LdapEntry entry=this.ldapServiceMapper.mapFromRegisteredService(this.baseDn,rs);
    operation.execute(new AddRequest(entry.getDn(),entry.getAttributes()));
    return rs;
  }
 catch (  final LdapException e) {
    log.error(e.getMessage(),e);
  }
 finally {
    LdapUtils.closeConnection(connection);
  }
  return null;
}
