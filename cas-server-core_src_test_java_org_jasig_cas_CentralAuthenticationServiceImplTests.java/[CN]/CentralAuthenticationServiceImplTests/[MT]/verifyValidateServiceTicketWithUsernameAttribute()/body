{
  final UsernamePasswordCredential cred=TestUtils.getCredentialsWithSameUsernameAndPassword();
  final AuthenticationContext ctx=getAuthenticationContext(cred);
  final TicketGrantingTicket ticketGrantingTicket=getCentralAuthenticationService().createTicketGrantingTicket(ctx);
  final Service svc=getService("eduPersonTest");
  final ServiceTicket serviceTicket=getCentralAuthenticationService().grantServiceTicket(ticketGrantingTicket.getId(),svc,ctx);
  final Assertion assertion=getCentralAuthenticationService().validateServiceTicket(serviceTicket.getId(),svc);
  assertEquals("developer",assertion.getPrimaryAuthentication().getPrincipal().getId());
}
