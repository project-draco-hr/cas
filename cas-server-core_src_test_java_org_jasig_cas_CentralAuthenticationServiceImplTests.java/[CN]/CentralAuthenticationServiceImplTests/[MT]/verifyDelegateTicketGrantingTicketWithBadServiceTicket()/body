{
  final AuthenticationContext ctx=getAuthenticationContext(getService(),TestUtils.getCredentialsWithSameUsernameAndPassword());
  final TicketGrantingTicket ticketId=getCentralAuthenticationService().createTicketGrantingTicket(ctx);
  final ServiceTicket serviceTicketId=getCentralAuthenticationService().grantServiceTicket(ticketId.getId(),getService(),ctx);
  getCentralAuthenticationService().destroyTicketGrantingTicket(ticketId.getId());
  final AuthenticationContext ctx2=getAuthenticationContext(getService(),org.jasig.cas.services.TestUtils.getHttpBasedServiceCredentials());
  getCentralAuthenticationService().createProxyGrantingTicket(serviceTicketId.getId(),ctx2);
}
