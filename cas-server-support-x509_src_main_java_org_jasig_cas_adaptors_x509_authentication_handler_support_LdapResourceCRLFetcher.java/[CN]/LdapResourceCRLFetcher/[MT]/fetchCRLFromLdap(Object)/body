{
  Connection connection=null;
  try {
    final String ldapURL=r.toString();
    logger.debug("Fetching CRL from ldap {}",ldapURL);
    connection=createConnection(ldapURL);
    logger.debug("Connected to {}. Searching {}",this.connectionConfig.getLdapUrl(),this.searchRequest);
    final SearchOperation searchOperation=new SearchOperation(connection);
    final Response<SearchResult> searchResult=searchOperation.execute(this.searchRequest);
    if (searchResult.getResultCode() == ResultCode.SUCCESS) {
      final LdapEntry entry=searchResult.getResult().getEntry();
      final LdapAttribute aval=entry.getAttribute(this.certificateRevocationListAttributeName);
      return fetchX509CRLFromAttribute(aval);
    }
    throw new CertificateException("Failed to establish a connection ldap. " + searchResult.getMessage());
  }
 catch (  final AuthenticationException|OperationNotSupportedException e) {
    logger.error(e.getMessage(),e);
    throw new CertificateException(e);
  }
 finally {
    if (connection != null) {
      connection.close();
    }
  }
}
