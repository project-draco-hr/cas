{
  List<Message> messageList=Collections.emptyList();
  if (this.ldapPasswordPolicyConfiguration != null) {
    final AccountState state=response.getAccountState();
    if (state != null) {
      logger.debug("Applying password policy to {}",state);
      messageList=this.ldapPasswordPolicyConfiguration.getAccountStateHandler().handle(state,ldapPasswordPolicyConfiguration);
    }
  }
  return new HandlerResult(this,new BasicCredentialMetaData(credential),createPrincipal(credential.getUsername(),response.getLdapEntry()),messageList);
}
