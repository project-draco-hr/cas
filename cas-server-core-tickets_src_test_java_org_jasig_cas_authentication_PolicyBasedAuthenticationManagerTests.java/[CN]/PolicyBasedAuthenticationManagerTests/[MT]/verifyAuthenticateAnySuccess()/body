{
  final PolicyBasedAuthenticationManager manager=new PolicyBasedAuthenticationManager(newMockHandler(true),newMockHandler(false));
  final Authentication auth=manager.authenticate(mock(Credential.class),mock(Credential.class));
  assertEquals(1,auth.getSuccesses().size());
  assertEquals(0,auth.getFailures().size());
  assertEquals(2,auth.getCredentials().size());
}
