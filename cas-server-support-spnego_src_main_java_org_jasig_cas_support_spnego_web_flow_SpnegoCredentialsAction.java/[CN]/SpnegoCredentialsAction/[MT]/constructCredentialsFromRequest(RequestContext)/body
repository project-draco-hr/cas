{
  final HttpServletRequest request=WebUtils.getHttpServletRequest(context);
  final String authorizationHeader=request.getHeader(SpnegoConstants.HEADER_AUTHORIZATION);
  if (StringUtils.hasText(authorizationHeader) && authorizationHeader.startsWith(this.messageBeginPrefix) && authorizationHeader.length() > this.messageBeginPrefix.length()) {
    if (logger.isDebugEnabled()) {
      logger.debug("SPNEGO Authorization header found with " + (authorizationHeader.length() - this.messageBeginPrefix.length()) + " bytes");
    }
    final byte[] token=Base64.decode(authorizationHeader.substring(this.messageBeginPrefix.length()));
    if (logger.isDebugEnabled()) {
      logger.debug("Obtained token: " + new String(token));
    }
    return new SpnegoCredentials(token);
  }
  return null;
}
