{
  final TokenCredential tokenCredential=(TokenCredential)credential;
  logger.debug("Locating token secret for service [{}]",tokenCredential.getService());
  final RegisteredService service=this.servicesManager.findServiceBy(tokenCredential.getService());
  final String tokenSecret=getRegisteredServiceJwtSecret(service);
  if (StringUtils.isNotBlank(tokenSecret)) {
    final JwtAuthenticator tokenAuthenticator=new JwtAuthenticator(tokenSecret);
    return tokenAuthenticator;
  }
  logger.warn("No token secret is defined for service [{}]. Ensure [{}] property is defined for service",service.getServiceId(),TokenConstants.PARAMETER_NAME_TOKEN);
  return null;
}
