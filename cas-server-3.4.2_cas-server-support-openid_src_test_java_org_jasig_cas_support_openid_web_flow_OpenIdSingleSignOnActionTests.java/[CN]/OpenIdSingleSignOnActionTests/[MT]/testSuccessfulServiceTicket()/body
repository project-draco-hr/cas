{
  final MockRequestContext context=new MockRequestContext();
  final MockHttpServletRequest request=new MockHttpServletRequest();
  final Authentication authentication=new MutableAuthentication(new SimplePrincipal("scootman28"));
  final TicketGrantingTicket t=new TicketGrantingTicketImpl("TGT-11",authentication,new NeverExpiresExpirationPolicy());
  this.ticketRegistry.addTicket(t);
  request.setParameter("openid.identity","http://openid.aol.com/scootman28");
  request.setParameter("openid.return_to","http://www.cnn.com");
  final OpenIdService service=OpenIdService.createServiceFrom(request);
  context.getFlowScope().put("service",service);
  context.getFlowScope().put("ticketGrantingTicketId",t.getId());
  context.setExternalContext(new ServletExternalContext(new MockServletContext(),request,new MockHttpServletResponse()));
  assertEquals("success",this.action.execute(context).getId());
}
