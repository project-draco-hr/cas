{
  KeyStore trustStore=null;
  FileInputStream instream=null;
  try {
    if (!trustStoreFile.exists() || !trustStoreFile.canRead()) {
      throw new FileNotFoundException("Truststore file cannot be located at " + trustStoreFile.getCanonicalPath());
    }
    trustStore=KeyStore.getInstance(this.trustStoreType);
    instream=new FileInputStream(this.trustStoreFile);
    trustStore.load(instream,this.trustStorePassword.toCharArray());
    LOGGER.debug("Loaded truststore file [{}] for proxy authentication",this.trustStoreFile);
    final SSLContext sslcontext=SSLContexts.custom().loadTrustMaterial(trustStore,new TrustSelfSignedStrategy()).build();
    final SSLConnectionSocketFactory sslsf=new SSLConnectionSocketFactory(sslcontext,this.supportedProtocols.toArray(new String[]{}),null,this.hostnameVerifier);
    return sslsf;
  }
 catch (  final Exception e) {
    LOGGER.error(e.getMessage(),e);
    throw new RuntimeException(e);
  }
 finally {
    IOUtils.closeQuietly(instream);
  }
}
