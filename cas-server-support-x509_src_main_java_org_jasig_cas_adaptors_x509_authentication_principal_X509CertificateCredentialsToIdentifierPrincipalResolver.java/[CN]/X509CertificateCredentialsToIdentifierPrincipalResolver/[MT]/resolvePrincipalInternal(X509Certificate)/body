{
  String username=this.identifier;
  logger.info("Creating principal for: {}",certificate.getSubjectDN().getName());
  for (final Matcher regexMatcher=this.subjectRegex.matcher(certificate.getSubjectDN().getName()); regexMatcher.find(); ) {
    final String name=regexMatcher.group(1).trim();
    final String value;
    if (regexMatcher.group(2) != null) {
      value=regexMatcher.group(2);
    }
 else {
      value=regexMatcher.group(3);
    }
    logger.debug(String.format("Parsed: %s - %s",name,value));
    username=username.replaceAll(new StringBuilder("\\$").append(name).toString(),value);
  }
  if (this.identifier.equals(username)) {
    return null;
  }
  return username;
}
