{
  while (System.currentTimeMillis() - ticketGrantingTicket.getCreationTime() < (HARD_TIMEOUT - SLIDING_TIMEOUT / 2)) {
    ticketGrantingTicket.grantServiceTicket("test",org.jasig.cas.services.TestUtils.getService(),expirationPolicy,false,true);
    Thread.sleep(SLIDING_TIMEOUT - TIMEOUT_BUFFER);
    assertFalse(this.ticketGrantingTicket.isExpired());
  }
  ticketGrantingTicket.grantServiceTicket("test",org.jasig.cas.services.TestUtils.getService(),expirationPolicy,false,true);
  Thread.sleep(SLIDING_TIMEOUT / 2 + TIMEOUT_BUFFER);
  assertTrue(ticketGrantingTicket.isExpired());
}
