{
  this.action=new GenerateServiceTicketAction();
  this.action.setCentralAuthenticationService(getCentralAuthenticationService());
  this.action.afterPropertiesSet();
  final AuthenticationContextBuilder builder=new DefaultAuthenticationContextBuilder(getAuthenticationSystemSupport().getPrincipalElectionStrategy());
  final AuthenticationTransaction transaction=AuthenticationTransaction.wrap(TestUtils.getCredentialsWithSameUsernameAndPassword());
  getAuthenticationSystemSupport().getAuthenticationTransactionManager().handle(transaction,builder);
  final AuthenticationContext ctx=builder.build(TestUtils.getService());
  this.ticketGrantingTicket=getCentralAuthenticationService().createTicketGrantingTicket(ctx);
}
