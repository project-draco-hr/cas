{
  final String GATEWAY="notNull";
  final String service="http://www.yale.edu";
  final String encodedService=URLEncoder.encode(service,"UTF-8");
  final String URLNOGW="/login?service=" + encodedService;
  final String URLGW="/login?service=" + encodedService + "&gateway="+ GATEWAY;
  beginAt(URLNOGW);
  setFormElement(FORM_USERNAME,getUsername());
  setFormElement(FORM_PASSWORD,getGoodPassword());
  submit();
  beginAt(URLGW);
  final String st=LoginHelper.serviceTicketFromResponse(getDialog().getResponse());
  assertNotNull(st);
  beginAt("/validate?ticket=" + st + "&service="+ encodedService);
  final HttpUnitDialog htDialog=getDialog();
  final String validateOutput=htDialog.getResponseText();
  final String expected="yes\n" + getUsername() + "\n";
  assertEquals(expected,validateOutput);
}
