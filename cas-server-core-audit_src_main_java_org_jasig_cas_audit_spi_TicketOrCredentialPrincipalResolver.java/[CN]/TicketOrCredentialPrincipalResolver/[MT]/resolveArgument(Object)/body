{
  LOGGER.debug("Resolving argument [{}] for audit",arg1.getClass().getSimpleName());
  if (arg1 instanceof Credential) {
    return arg1.toString();
  }
 else   if (arg1 instanceof String) {
    try {
      final Ticket ticket=this.centralAuthenticationService.getTicket((String)arg1,Ticket.class);
      org.jasig.cas.authentication.Authentication casAuthentication=null;
      if (ticket instanceof ServiceTicket) {
        casAuthentication=ServiceTicket.class.cast(ticket).getGrantingTicket().getAuthentication();
      }
 else       if (ticket instanceof TicketGrantingTicket) {
        casAuthentication=TicketGrantingTicket.class.cast(ticket).getAuthentication();
      }
      return this.principalIdProvider.getPrincipalIdFrom(casAuthentication);
    }
 catch (    final InvalidTicketException e) {
      LOGGER.trace(e.getMessage(),e);
    }
    LOGGER.debug("Could not locate ticket [{}] in the registry",arg1);
  }
 else {
    return WebUtils.getAuthenticatedUsername();
  }
  LOGGER.debug("Unable to determine the audit argument. Returning [{}]",UNKNOWN_USER);
  return UNKNOWN_USER;
}
