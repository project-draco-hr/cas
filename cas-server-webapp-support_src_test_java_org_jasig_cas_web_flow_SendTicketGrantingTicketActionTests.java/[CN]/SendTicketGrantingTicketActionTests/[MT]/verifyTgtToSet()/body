{
  final MockHttpServletResponse response=new MockHttpServletResponse();
  final MockHttpServletRequest request=new MockHttpServletRequest();
  final TicketGrantingTicket tgt=mock(TicketGrantingTicket.class);
  when(tgt.getId()).thenReturn("test");
  WebUtils.putTicketGrantingTicketInScopes(this.context,tgt);
  this.context.setExternalContext(new ServletExternalContext(new MockServletContext(),request,response));
  assertEquals("success",this.action.execute(this.context).getId());
  request.setCookies(response.getCookies());
  assertEquals(tgt.getId(),this.ticketGrantingTicketCookieGenerator.retrieveCookieValue(request));
}
