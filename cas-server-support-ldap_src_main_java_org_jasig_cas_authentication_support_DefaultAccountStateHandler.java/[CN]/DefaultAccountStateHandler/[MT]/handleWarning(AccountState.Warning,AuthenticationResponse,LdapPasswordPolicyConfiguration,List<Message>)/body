{
  if (warning == null) {
    logger.debug("Account state warning not defined");
    return;
  }
  final Calendar expDate=warning.getExpiration();
  final Days ttl=Days.daysBetween(Instant.now(),new Instant(expDate));
  logger.debug("Password expires in {} days. Expiration warning threshold is {} days.",ttl.getDays(),configuration.getPasswordWarningNumberOfDays());
  if (ttl.getDays() < configuration.getPasswordWarningNumberOfDays()) {
    messages.add(new PasswordExpiringWarningMessage("Password expires in {0} days. Please change your password at <href=\"{1}\">{1}</a>",ttl.getDays(),configuration.getPasswordPolicyUrl()));
  }
  if (warning.getLoginsRemaining() > 0) {
    messages.add(new Message("password.expiration.loginsRemaining","You have {0} logins remaining before you MUST change your password.",warning.getLoginsRemaining()));
  }
}
