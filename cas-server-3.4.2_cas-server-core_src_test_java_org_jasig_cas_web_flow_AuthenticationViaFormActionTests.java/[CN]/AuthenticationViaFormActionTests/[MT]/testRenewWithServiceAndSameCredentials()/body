{
  final String ticketGrantingTicket=getCentralAuthenticationService().createTicketGrantingTicket(TestUtils.getCredentialsWithSameUsernameAndPassword());
  final MockHttpServletRequest request=new MockHttpServletRequest();
  final MockRequestContext context=new MockRequestContext();
  context.getFlowScope().put("ticketGrantingTicketId",ticketGrantingTicket);
  request.addParameter("renew","true");
  request.addParameter("service","test");
  request.addParameter("username","test");
  request.addParameter("password","test");
  context.setExternalContext(new ServletExternalContext(new MockServletContext(),request,new MockHttpServletResponse()));
  context.getFlowScope().put("service",TestUtils.getService("test"));
}
