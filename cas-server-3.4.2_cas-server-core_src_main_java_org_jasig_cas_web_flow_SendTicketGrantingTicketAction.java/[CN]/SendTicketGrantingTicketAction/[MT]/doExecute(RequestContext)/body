{
  final String ticketGrantingTicketId=WebUtils.getTicketGrantingTicketId(context);
  final String ticketGrantingTicketValueFromCookie=(String)context.getFlowScope().get("ticketGrantingTicketId");
  if (ticketGrantingTicketId == null) {
    return success();
  }
  this.ticketGrantingTicketCookieGenerator.addCookie(WebUtils.getHttpServletRequest(context),WebUtils.getHttpServletResponse(context),ticketGrantingTicketId);
  if (ticketGrantingTicketValueFromCookie != null && !ticketGrantingTicketId.equals(ticketGrantingTicketValueFromCookie)) {
    this.centralAuthenticationService.destroyTicketGrantingTicket(ticketGrantingTicketValueFromCookie);
  }
  return success();
}
