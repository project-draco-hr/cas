{
  final List<LogoutRequest> logoutRequests=(List<LogoutRequest>)context.getFlowScope().get(LOGOUT_REQUESTS);
  final Integer startIndex=(Integer)context.getFlowScope().get(LOGOUT_INDEX);
  if (logoutRequests != null && startIndex != null) {
    for (int i=startIndex; i < logoutRequests.size(); i++) {
      final LogoutRequest logoutRequest=logoutRequests.get(i);
      if (logoutRequest.getStatus() == LogoutRequestStatus.NOT_ATTEMPTED) {
        logoutRequest.setStatus(LogoutRequestStatus.SUCCESS);
        final HttpServletResponse response=WebUtils.getHttpServletResponse(context);
        preventCaching(response);
        context.getFlowScope().put(LOGOUT_INDEX,i + 1);
        final UriComponentsBuilder builder=UriComponentsBuilder.fromHttpUrl(logoutRequest.getService().getId());
        builder.queryParam("SAMLRequest",URLEncoder.encode(logoutManager.createFrontChannelLogoutMessage(logoutRequest),"UTF-8"));
        return result(REDIRECT_APP_EVENT,"logoutUrl",builder.build().toUriString());
      }
    }
  }
  return new Event(this,FINISH_EVENT);
}
