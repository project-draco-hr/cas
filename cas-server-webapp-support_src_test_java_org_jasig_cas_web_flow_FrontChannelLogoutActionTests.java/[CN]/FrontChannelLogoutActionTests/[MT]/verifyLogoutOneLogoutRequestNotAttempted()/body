{
  final String FAKE_URL="http://url";
  final LogoutRequest logoutRequest=new LogoutRequest(TICKET_ID,new SimpleWebApplicationServiceImpl(FAKE_URL));
  WebUtils.putLogoutRequests(this.requestContext,Arrays.asList(logoutRequest));
  this.requestContext.getFlowScope().put(FrontChannelLogoutAction.LOGOUT_INDEX,0);
  final Event event=this.frontChannelLogoutAction.doExecute(this.requestContext);
  assertEquals(FrontChannelLogoutAction.REDIRECT_APP_EVENT,event.getId());
  final List<LogoutRequest> list=WebUtils.getLogoutRequests(this.requestContext);
  assertEquals(1,list.size());
  final String url=(String)event.getAttributes().get("logoutUrl");
  assertTrue(url.startsWith(FAKE_URL + "?SAMLRequest="));
  final byte[] samlMessage=Base64.decodeBase64(URLDecoder.decode(StringUtils.substringAfter(url,"?SAMLRequest="),"UTF-8"));
  final Inflater decompresser=new Inflater();
  decompresser.setInput(samlMessage);
  final byte[] result=new byte[1000];
  decompresser.inflate(result);
  decompresser.end();
  final String message=new String(result);
  assertTrue(message.startsWith("<samlp:LogoutRequest xmlns:samlp=\"urn:oasis:names:tc:SAML:2.0:protocol\" ID=\""));
  assertTrue(message.indexOf("<samlp:SessionIndex>" + TICKET_ID + "</samlp:SessionIndex>") >= 0);
}
