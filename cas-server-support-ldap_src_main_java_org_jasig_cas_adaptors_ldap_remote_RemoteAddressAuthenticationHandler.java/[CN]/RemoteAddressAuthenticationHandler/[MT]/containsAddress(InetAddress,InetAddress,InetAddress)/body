{
  log.debug("Checking IP address: {} in ",ip,network,netmask);
  byte[] networkBytes=network.getAddress();
  byte[] netmaskBytes=netmask.getAddress();
  byte[] ipBytes=ip.getAddress();
  if (networkBytes.length != netmaskBytes.length || netmaskBytes.length != ipBytes.length) {
    log.debug("Network address {}, subnet mask {} and/or host address {}" + " have different sizes! (return false ...)",network,netmask,ip);
    return false;
  }
  for (int i=0; i < netmaskBytes.length; i++) {
    int mask=netmaskBytes[i] & 0xff;
    if ((networkBytes[i] & mask) != (ipBytes[i] & mask)) {
      log.debug("{} is not in {}/{}",ip,network,netmask);
      return false;
    }
  }
  log.debug("{} is in {}/{}",ip,network,netmask);
  return true;
}
