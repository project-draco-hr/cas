{
  final ClientInfo clientInfo=ClientInfoHolder.getClientInfo();
  final String clientIp=clientInfo.getClientIpAddress();
  logger.debug("Located client IP address as {}",clientIp);
  if (isClientIpAddressRejected(clientIp)) {
    logger.warn("Client IP {} is rejected for authentication",clientIp);
    return false;
  }
  if (isUserAgentRejected(userAgent)) {
    logger.warn("User agent {} is rejected for authentication",userAgent);
    return false;
  }
  logger.debug("User agent {} is authorized to proceed",userAgent);
  if (this.geoLocationService != null) {
    final GeoLocationResponse loc=getGeoLocation(clientIp,location);
    if (loc != null) {
      logger.debug("Determined geolocation to be {}",loc);
      if (isGeoLocationCountryRejected(loc)) {
        logger.warn("Client {} is rejected for authentication",clientIp);
        return false;
      }
    }
 else {
      logger.info("Could not determine geolocation for {}",clientIp);
    }
  }
  return true;
}
