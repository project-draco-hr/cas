{
  final PooledSearchDnResolver resolver=new PooledSearchDnResolver();
  resolver.setBaseDn(l.getBaseDn());
  resolver.setSubtreeSearch(l.isSubtreeSearch());
  resolver.setAllowMultipleDns(l.isAllowMultipleDns());
  resolver.setConnectionFactory(Beans.newPooledConnectionFactory(l));
  resolver.setUserFilter(l.getUserFilter());
  if (StringUtils.isBlank(l.getPrincipalAttributePassword())) {
    return new Authenticator(resolver,getPooledBindAuthenticationHandler(l));
  }
 else {
    return new Authenticator(resolver,getPooledCustomCompareAuthenticationHandler(l));
  }
}
