{
  final String service=getServiceUrl();
  String encodedService=URLEncoder.encode(service,"UTF-8");
  beginAt("/login?service=" + encodedService + "&renew=true");
  setFormElement("username",getUsername());
  setFormElement("password",getGoodPassword());
  submit();
  String serviceTicket=LoginHelper.serviceTicketFromResponse(getDialog().getResponse());
  assertNotNull(serviceTicket);
  beginAt(getValidationPath() + "?ticket=" + serviceTicket+ "&service="+ encodedService+ "&renew=true");
  assertTextPresent("cas:authenticationSuccess");
}
