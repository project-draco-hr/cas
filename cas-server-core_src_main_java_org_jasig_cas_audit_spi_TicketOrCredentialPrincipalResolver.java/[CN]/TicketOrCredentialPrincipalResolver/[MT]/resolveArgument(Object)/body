{
  LOGGER.debug("Resolving argument [{}] for audit",arg1.getClass().getSimpleName());
  if (arg1 instanceof Credential) {
    return arg1.toString();
  }
 else   if (arg1 instanceof String) {
    try {
      final Ticket ticket=this.centralAuthenticationService.getTicket((String)arg1,Ticket.class);
      if (ticket instanceof ServiceTicket) {
        final ServiceTicket serviceTicket=(ServiceTicket)ticket;
        return serviceTicket.getGrantingTicket().getAuthentication().getPrincipal().getId();
      }
 else       if (ticket instanceof TicketGrantingTicket) {
        final TicketGrantingTicket tgt=(TicketGrantingTicket)ticket;
        return tgt.getAuthentication().getPrincipal().getId();
      }
    }
 catch (    final InvalidTicketException e) {
      LOGGER.trace(e.getMessage(),e);
    }
    LOGGER.debug("Could not locate ticket [{}] in the registry",arg1);
  }
 else {
    return WebUtils.getAuthenticatedUsername();
  }
  LOGGER.debug("Unable to determine the audit argument. Returning [{}]",UNKNOWN_USER);
  return UNKNOWN_USER;
}
