{
  try {
    final MessageDigest md=MessageDigest.getInstance("SHA");
    md.update(RandomStringUtils.randomAlphabetic(16).getBytes());
    md.update(CONST_SEPARATOR);
    md.update(principal.getId().getBytes());
    md.update(CONST_SEPARATOR);
    return Base64.encodeBase64String(md.digest(this.salt)).replaceAll(System.getProperty("line.separator"),"");
  }
 catch (  final NoSuchAlgorithmException e) {
    throw new RuntimeException(e);
  }
}
