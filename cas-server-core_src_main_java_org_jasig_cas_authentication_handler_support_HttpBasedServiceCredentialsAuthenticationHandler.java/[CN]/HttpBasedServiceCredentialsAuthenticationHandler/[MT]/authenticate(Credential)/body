{
  final HttpBasedServiceCredential httpCredential=(HttpBasedServiceCredential)credential;
  if (this.requireSecure && !httpCredential.getCallbackUrl().getProtocol().equals(PROTOCOL_HTTPS)) {
    log.debug("Authentication failed because url was not secure.");
    throw new FailedLoginException();
  }
  log.debug("Attempting to resolve credential for {}",httpCredential);
  if (!this.httpClient.isValidEndPoint(httpCredential.getCallbackUrl())) {
    throw new FailedLoginException();
  }
  return new HandlerResult(this,httpCredential,new SimplePrincipal(httpCredential.getId()));
}
