{
  final MultiTimeUseOrTimeoutExpirationPolicy expected=new MultiTimeUseOrTimeoutExpirationPolicy(1,5000);
  final MultiTimeUseOrTimeoutExpirationPolicySerializer serialzer=new MultiTimeUseOrTimeoutExpirationPolicySerializer(new FieldHelper());
  final ByteBuffer buffer=ByteBuffer.allocate(128);
  serialzer.write(buffer,expected);
  buffer.flip();
  final MultiTimeUseOrTimeoutExpirationPolicy actual=serialzer.read(buffer);
  final TicketState ticket=mock(TicketState.class);
  when(ticket.getLastTimeUsed()).thenReturn(System.currentTimeMillis() - 5001);
  Assert.assertEquals(expected.isExpired(ticket),actual.isExpired(ticket));
}
