{
  if (this.ldapErrorDefinitions == null || this.ldapErrorDefinitions.size() == 0) {
    if (this.log.isDebugEnabled())     this.log.debug("No error definitions are defined. Throwing error " + e.getMessage());
    return BadCredentialsAuthenticationException.ERROR;
  }
  if (this.log.isDebugEnabled())   this.log.debug("Handling error: " + e.getMessage());
  for (  final LdapErrorDefinition ldapErrorDef : this.ldapErrorDefinitions)   if (ldapErrorDef.matches(e.getMessage())) {
    if (this.log.isDebugEnabled())     this.log.debug("Found error type " + ldapErrorDef.getType() + ". Throwing error for "+ e.getMessage());
    return new LdapAuthenticationException(BadCredentialsAuthenticationException.CODE,e.getMessage(),ldapErrorDef.getType());
  }
  if (this.log.isDebugEnabled())   this.log.debug("No error definition could be matched against the error. Throwing default error for " + e.getMessage());
  return BadCredentialsAuthenticationException.ERROR;
}
