{
  final BindModeSearchDatabaseAuthenticationHandler h=new BindModeSearchDatabaseAuthenticationHandler();
  h.setDataSource(Beans.newHickariDataSource(b));
  h.setPasswordEncoder(Beans.newPasswordEncoder(b.getPasswordEncoder()));
  h.setPrincipalNameTransformer(Beans.newPrincipalNameTransformer(b.getPrincipalTransformation()));
  if (bindSearchPasswordPolicyConfiguration != null) {
    h.setPasswordPolicyConfiguration(bindSearchPasswordPolicyConfiguration);
  }
  h.setPrincipalNameTransformer(Beans.newPrincipalNameTransformer(b.getPrincipalTransformation()));
  h.setPrincipalFactory(jdbcPrincipalFactory());
  h.setServicesManager(servicesManager);
  return h;
}
