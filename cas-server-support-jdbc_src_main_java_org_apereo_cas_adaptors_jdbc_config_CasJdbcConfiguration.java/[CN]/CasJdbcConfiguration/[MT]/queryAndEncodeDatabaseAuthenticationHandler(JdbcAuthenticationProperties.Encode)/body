{
  final QueryAndEncodeDatabaseAuthenticationHandler h=new QueryAndEncodeDatabaseAuthenticationHandler();
  h.setAlgorithmName(b.getAlgorithmName());
  h.setNumberOfIterationsFieldName(b.getNumberOfIterationsFieldName());
  h.setNumberOfIterations(b.getNumberOfIterations());
  h.setPasswordFieldName(b.getPasswordFieldName());
  h.setSaltFieldName(b.getSaltFieldName());
  h.setSql(b.getSql());
  h.setStaticSalt(b.getStaticSalt());
  h.setDataSource(Beans.newHickariDataSource(b));
  h.setPasswordEncoder(Beans.newPasswordEncoder(b.getPasswordEncoder()));
  h.setPrincipalNameTransformer(Beans.newPrincipalNameTransformer(b.getPrincipalTransformation()));
  if (queryAndEncodePasswordPolicyConfiguration != null) {
    h.setPasswordPolicyConfiguration(queryAndEncodePasswordPolicyConfiguration);
  }
  h.setPrincipalNameTransformer(Beans.newPrincipalNameTransformer(b.getPrincipalTransformation()));
  h.setPrincipalFactory(jdbcPrincipalFactory());
  h.setServicesManager(servicesManager);
  return h;
}
