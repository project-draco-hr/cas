{
  OAuthCredentials oauthCredentials=(OAuthCredentials)credentials;
  String token=oauthCredentials.getToken();
  logger.debug("token : {}",token);
  String verifier=oauthCredentials.getVerifier();
  logger.debug("verifier : {}",verifier);
  String providerName=oauthCredentials.getProviderName();
  logger.debug("providerName : {}",providerName);
  OAuthProvider provider=null;
  for (  OAuthProvider aProvider : providers) {
    if (StringUtils.equals(providerName,aProvider.getName())) {
      provider=aProvider;
      break;
    }
  }
  HttpServletRequest request=(HttpServletRequest)ExternalContextHolder.getExternalContext().getNativeRequest();
  Token accessToken=provider.getAccessToken(request.getSession(),token,verifier);
  String userId=provider.getUserId(accessToken);
  logger.debug("userId : {}",userId);
  if (StringUtils.isNotBlank(userId)) {
    oauthCredentials.setUserId(userId);
    return true;
  }
 else {
    oauthCredentials.setUserId(null);
    return false;
  }
}
