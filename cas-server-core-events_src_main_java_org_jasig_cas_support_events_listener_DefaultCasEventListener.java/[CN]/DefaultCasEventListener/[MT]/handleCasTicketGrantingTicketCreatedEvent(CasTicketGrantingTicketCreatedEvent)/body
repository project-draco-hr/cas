{
  if (casEventRepository != null) {
    final CasEventDTO dto=new CasEventDTO();
    dto.setType(event.getClass().getCanonicalName());
    dto.putTimestamp(event.getTimestamp());
    dto.putCreationTime(event.getTicketGrantingTicket().getCreationTime());
    dto.putId(event.getTicketGrantingTicket().getId());
    final ClientInfo clientInfo=ClientInfoHolder.getClientInfo();
    dto.putClientIpAddress(clientInfo.getClientIpAddress());
    dto.putServerIpAddress(clientInfo.getServerIpAddress());
    dto.putAgent(WebUtils.getHttpServletRequestUserAgent());
    casEventRepository.save(dto);
  }
}
