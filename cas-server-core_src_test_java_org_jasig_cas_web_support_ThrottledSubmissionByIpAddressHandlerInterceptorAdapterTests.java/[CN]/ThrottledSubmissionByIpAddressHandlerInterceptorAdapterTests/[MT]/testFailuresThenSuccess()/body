{
  final MockHttpServletRequest request=new MockHttpServletRequest();
  request.setMethod("POST");
  request.setRemoteAddr("111.111.111.111");
  MockRequestContext context=new MockRequestContext();
  context.setCurrentEvent(new Event("","error"));
  request.setAttribute("flowRequestContext",context);
  for (int i=0; i < CONST_FAILURE_THRESHHOLD + 1; i++) {
    this.adapter.postHandle(request,new MockHttpServletResponse(),new Object(),null);
  }
  assertFalse(this.adapter.preHandle(request,new MockHttpServletResponse(),new Object()));
  for (int i=0; i < CONST_FAILURE_THRESHHOLD; i++) {
    this.adapter.decrementCounts();
  }
  assertTrue(this.adapter.preHandle(request,new MockHttpServletResponse(),new Object()));
}
