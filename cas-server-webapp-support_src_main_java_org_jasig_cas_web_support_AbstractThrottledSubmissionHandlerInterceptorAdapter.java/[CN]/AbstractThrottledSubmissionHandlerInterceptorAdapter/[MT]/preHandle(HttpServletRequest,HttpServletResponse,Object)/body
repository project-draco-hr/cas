{
  if (!"POST".equals(request.getMethod())) {
    return true;
  }
  if (exceedsThreshold(request)) {
    recordThrottle(request);
    request.setAttribute(WebUtils.CAS_ACCESS_DENIED_REASON,"screen.blocked.message");
    response.sendError(HttpStatus.SC_FORBIDDEN,"Access Denied for user [" + request.getParameter(usernameParameter) + "] from IP Address ["+ request.getRemoteAddr()+ "]");
    return false;
  }
  return true;
}
