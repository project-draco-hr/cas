{
  RegisteredService service=(RegisteredService)command;
  if (this.getCommandClass() == null) {
    if (service.getId() == RegisteredService.INITIAL_IDENTIFIER_VALUE && service.getServiceId().startsWith("^")) {
      logger.debug("Detected regular expression starting with ^");
      final RegexRegisteredService regexService=new RegexRegisteredService();
      regexService.copyFrom(service);
      service=regexService;
    }
  }
  this.servicesManager.save(service);
  logger.info("Saved changes to service " + service.getId());
  final ModelAndView modelAndView=new ModelAndView(new RedirectView("manage.html#" + service.getId(),true));
  modelAndView.addObject("action","add");
  modelAndView.addObject("id",service.getId());
  return modelAndView;
}
